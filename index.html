<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–¶–∏—Ñ—Ä–æ–≤–∞—è –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –æ–±—Å–µ—Ä–≤–∞—Ç–æ—Ä–∏—è: –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Å—É–±—ä–µ–∫—Ç–æ–≤ –†–§ –¥–æ 2100 –≥.</title>
  <!-- Plotly –¥–ª—è –≥—Ä–∞—Ñ–∏–∫–æ–≤, PapaParse –¥–ª—è CSV, SheetJS –¥–ª—è XLSX -->
  <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <style>
    :root{
      --bg:#ffffff; --fg:#111; --muted:#666; --grid:#e7e7e7; --accent:#1f77b4; --accent2:#d62728; --accent3:#2ca02c; --accent4:#9467bd; --accent5:#ff7f0e;
    }
    html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);font:16px/1.45 system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif}
    header{padding:16px 20px;border-bottom:1px solid var(--grid)}
    h1{margin:0 0 4px 0;font-size:22px;font-weight:500}
    .sub{color:var(--muted);font-size:14px;max-width:900px}
    main{max-width:1240px;margin:0 auto;padding:16px}
    .panel{display:grid;grid-template-columns:2fr 1fr;gap:12px;margin-bottom:12px;align-items:start}
    .card{border:1px solid var(--grid);border-radius:12px;padding:14px;background:#fafafa;box-shadow:0 2px 6px rgba(0,0,0,.04)}
    label{font-size:13px;color:var(--muted);display:block;margin-bottom:6px}
    select, input[type="range"], button{width:100%;padding:8px;border:1px solid var(--grid);border-radius:10px;background:#fff;font-size:14px}
    button{cursor:pointer;transition:all .15s ease;border-color:#dcdcdc}
    button:hover{background:#f2f2f2}
    .row{display:grid;grid-template-columns:repeat(3, 1fr);gap:12px}
    .charts{display:grid;grid-template-columns:1fr;gap:18px}
    .grid2{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .small{font-size:12px;color:var(--muted)}
    .legend-pill{display:inline-block;padding:2px 8px;border-radius:999px;border:1px solid var(--grid);margin-right:6px;font-size:12px}
    .err{color:#b00020;font-size:13px}
    footer{max-width:1240px;margin:24px auto 32px auto;padding:0 16px;color:var(--muted);font-size:12px;text-align:right}
    #logBox{margin-top:16px;white-space:pre-line}
    .card-header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:10px}
    .card-header h3{margin:0;font-size:18px;font-weight:600;color:#222}
    .card-header .eyebrow{color:var(--muted);font-size:12px;text-transform:uppercase;letter-spacing:.05em;margin-bottom:3px}
    .card-actions{display:flex;gap:8px;flex-wrap:wrap;justify-content:flex-end}
    .pill-row{display:flex;align-items:center;gap:12px;flex-wrap:wrap;font-size:13px;color:var(--muted)}
    .control-inline{display:flex;gap:10px;align-items:center;flex-wrap:wrap}
    .control-inline select{width:auto;min-width:180px}
    .control-inline label{margin:0;display:flex;align-items:center;gap:6px}
    .plot{height:100%}
    .tall{min-height:460px}
    .mid{min-height:360px}
    .slim{min-height:320px}
    .methods details{margin-bottom:10px;border:1px solid var(--grid);border-radius:10px;padding:10px;background:#fff}
    .methods summary{font-weight:600;cursor:pointer}
    .method-text{white-space:pre-wrap;font-family:inherit;line-height:1.5;font-size:14px;margin:8px 0 0 0;text-align:justify}
    .methods .math{font-family:"Cambria Math","Times New Roman",serif;font-style:italic}
    .methods .math sub,.methods .math sup{font-style:normal}
    @media (max-width:900px){
      .panel{grid-template-columns:1fr}
      .grid2{grid-template-columns:1fr}
      .card-header{flex-direction:column;align-items:flex-start}
      .card-actions{width:100%;justify-content:flex-start}
    }
  </style>
</head>
<body>
<header>
  <h1>–¶–∏—Ñ—Ä–æ–≤–∞—è –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –æ–±—Å–µ—Ä–≤–∞—Ç–æ—Ä–∏—è: –ø—Ä–æ–≥–Ω–æ–∑ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–µ–π —Å—É–±—ä–µ–∫—Ç–æ–≤ –†–§ –¥–æ 2100 –≥.</h1>
  <div class="sub">
    –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ –∑–∞ —Å—á—ë—Ç —Å—Ä–µ–¥—Å—Ç–≤ –≥—Ä–∞–Ω—Ç–∞ –†–æ—Å—Å–∏–π—Å–∫–æ–≥–æ –Ω–∞—É—á–Ω–æ–≥–æ —Ñ–æ–Ω–¥–∞ ‚Ññ 25-78-30004
    ¬´–¶–∏—Ñ—Ä–æ–≤–∞—è –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è –æ–±—Å–µ—Ä–≤–∞—Ç–æ—Ä–∏—è: —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞ —Å–∏—Å—Ç–µ–º—ã –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
    –≤ —Ä–µ–≥–∏–æ–Ω–∞—Ö –†–æ—Å—Å–∏–∏ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –ì–ò–°-—Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π –∏ –±–æ–ª—å—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö¬ª, https://rscf.ru/project/25-78-30004/
  </div>
</header>
<main>
  <div class="panel">
    <div class="card">
      <label for="territorySel">–°—É–±—ä–µ–∫—Ç –†–æ—Å—Å–∏–π—Å–∫–æ–π –§–µ–¥–µ—Ä–∞—Ü–∏–∏</label>
      <select id="territorySel"></select>
    </div>
  </div>

  <div class="charts">
    <div class="card tall">
      <div class="card-header">
        <div>
          <div class="eyebrow">–î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑</div>
          <h3>–û–±—â–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è, —á–µ–ª–æ–≤–µ–∫</h3>
        </div>
        <div class="card-actions">
          <button id="btnPopPNG">PNG</button>
          <button id="btnPopXLSX">XLSX</button>
        </div>
      </div>
      <div id="chartPop" class="plot" style="height:430px"></div>
    </div>

    <div class="grid2">
      <div class="card mid">
        <div class="card-header">
          <div>
            <div class="eyebrow">–†–æ–∂–¥–∞–µ–º–æ—Å—Ç—å</div>
            <h3>–°—É–º–º–∞—Ä–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏, –¥–µ—Ç–µ–π –Ω–∞ –∂–µ–Ω—â–∏–Ω—É</h3>
          </div>
          <div class="card-actions">
            <button id="btnTFRPNG">PNG</button>
            <button id="btnTFRXLSX">XLSX</button>
          </div>
        </div>
        <div id="chartTFR" class="plot" style="height:320px"></div>
      </div>
      <div class="card mid">
        <div class="card-header">
          <div>
            <div class="eyebrow">–û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∂–∏–∑–Ω–∏</div>
            <h3>–û–ü–ñ –ø—Ä–∏ —Ä–æ–∂–¥–µ–Ω–∏–∏, –ª–µ—Ç</h3>
          </div>
          <div class="card-actions">
            <button id="btnLEPNG">PNG</button>
            <button id="btnLEXLSX">XLSX</button>
          </div>
        </div>
        <div id="chartLE" class="plot" style="height:320px"></div>
      </div>
    </div>

    <div class="card mid">
      <div class="card-header" style="flex-wrap:wrap; gap:16px">
        <div>
          <div class="eyebrow">–ú–∏–≥—Ä–∞—Ü–∏—è –Ω–∞—Å–µ–ª–µ–Ω–∏—è</div>
          <h3>–ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–∞–ª—å–¥–æ –∏ –ø–æ—Ç–æ–∫–∏, —á–µ–ª–æ–≤–µ–∫</h3>
        </div>
        <div class="control-inline" style="margin-left:auto">
          <label><input type="checkbox" id="chkMigMale" checked> –ú—É–∂—á–∏–Ω—ã</label>
          <label><input type="checkbox" id="chkMigFem" checked> –ñ–µ–Ω—â–∏–Ω—ã</label>
          <label><input type="checkbox" id="chkMigTot" checked> –í—Å–µ–≥–æ</label>
        </div>
        <div class="card-actions">
          <button id="btnMigPNG">PNG</button>
          <button id="btnMigXLSX">XLSX</button>
        </div>
      </div>
      <div id="chartMIG" class="plot" style="height:360px"></div>
    </div>

    <div class="card mid">
      <div class="card-header" style="flex-wrap:wrap;gap:14px">
        <div>
          <div class="eyebrow">–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è</div>
          <h3>–ü–æ–ª–æ–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –ø–∏—Ä–∞–º–∏–¥–∞, —á–µ–ª–æ–≤–µ–∫</h3>
        </div>
        <div class="control-inline">
          <label for="scenarioSel">–°—Ü–µ–Ω–∞—Ä–∏–π —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞—Å–µ–ª–µ–Ω–∏—è</label>
          <select id="scenarioSel">
            <option value="withMIG">–° —É—á—ë—Ç–æ–º –º–∏–≥—Ä–∞—Ü–∏–∏</option>
            <option value="noMIG">–ë–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏</option>
          </select>
        </div>
        <div class="control-inline" style="flex:1;min-width:260px">
          <label for="yearRange" style="flex:0 0 auto">–ì–æ–¥:</label>
          <input id="yearInput" type="number" min="2017" max="2100" step="1" value="2025" style="width:100px"/>
          <input id="yearRange" type="range" min="2017" max="2100" step="1" value="2025" style="flex:1"/>
        </div>
        <div class="card-actions">
          <button id="btnPyrPNG">PNG</button>
          <button id="btnPyrXLSX">XLSX</button>
        </div>
      </div>
      <div id="chartPYR" class="plot" style="height:430px"></div>
    </div>
  </div>

  <div class="card">
    <div class="card-header">
      <div>
        <div class="eyebrow">–ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã</div>
        <h3>–ê–≤—Ç–æ—Ä—Å–∫–∏–µ –º–µ—Ç–æ–¥–∏–∫–∏ —Ä–∞—Å—á—ë—Ç–∞ –ø—Ä–æ–≥–Ω–æ–∑–æ–≤</h3>
      </div>
    </div>
    <div class="methods">
      <details>
        <summary>–°—É–º–º–∞—Ä–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏</summary>
        <pre class="method-text">–ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞ —Å—É–º–º–∞—Ä–Ω–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏ (–°–ö–†) –¥–æ 2100 –≥–æ–¥–∞
(–†–æ—Å—Å–∏–π—Å–∫–∞—è –§–µ–¥–µ—Ä–∞—Ü–∏—è, —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –æ–∫—Ä—É–≥–∞, –≤—Å–µ —Å—É–±—ä–µ–∫—Ç—ã; –≥–æ–¥–æ–≤–∞—è —à–∫–∞–ª–∞ 1990‚Äì2100)
1. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ —Ü–µ–ª—å —Ä–∞—Å—á—ë—Ç–∞
–í—Ö–æ–¥ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω—É—é –ø–∞–Ω–µ–ª—å –≥–æ–¥–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –°–ö–† –ø–æ –≤—Å–µ–º —Å—Ç—Ä–æ–∫–∞–º –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞ ¬´–°—É–º–º–∞—Ä–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏ 1990‚Äì2024.xlsx¬ª (–ª–∏—Å—Ç ¬´–î–∞–Ω–Ω—ã–µ¬ª), –≥–¥–µ –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏, –∞ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã ‚Äî –≥–æ–¥—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏–π. –î–ª—è –∫–∞–∂–¥–æ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤—Å—è –¥–æ—Å—Ç—É–ø–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∑–∞ 1990‚Äì2024 –≥–æ–¥—ã; –ø—Ä–æ–ø—É—Å–∫–∏ –≤ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è—Ö –ø—Ä–∏–≤–æ–¥—è—Ç—Å—è –∫ —á–∏—Å–ª–æ–≤–æ–º—É —Ñ–æ—Ä–º–∞—Ç—É —Å –º—è–≥–∫–æ–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–µ–π —Ç–æ–ª—å–∫–æ –≤–Ω—É—Ç—Ä–∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–∏ –µ–¥–∏–Ω–∏—á–Ω—ã—Ö —Ä–∞–∑—Ä—ã–≤–∞—Ö. –¶–µ–ª—å—é —è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –≥–æ–¥–æ–≤—ã—Ö –ø—Ä–æ–≥–Ω–æ–∑–æ–≤ –¥–æ 2100 –≥–æ–¥–∞ —Å –≤–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω–æ–π –¥–∏–Ω–∞–º–∏–∫–æ–π, —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π –¥–ª—è –ø–æ—Å—Ç—Ç—Ä–∞–Ω–∑–∏—Ç–Ω–æ–π —Ñ–µ—Ä—Ç–∏–ª—å–Ω–æ—Å—Ç–∏, –±–µ–∑ –Ω–∞–≤—è–∑–∞–Ω–Ω—ã—Ö ¬´–Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö¬ª –ø–æ–¥—ä—ë–º–æ–≤ –∏ –±–µ–∑ –ø–ª–æ—Å–∫–∏—Ö —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–π.
2. –û–±—â–∞—è —Å—Ö–µ–º–∞ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è
–ú–µ—Ç–æ–¥ –≤–∫–ª—é—á–∞–µ—Ç –¥–≤–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏ —Å—Ç—Ä–æ–≥–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, –æ–±—ä–µ–¥–∏–Ω—ë–Ω–Ω—ã—Ö –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ–º. –ü–µ—Ä–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî –≥–∞—É—Å—Å–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ (Gaussian Process Regression, GPR) –Ω–∞ –≤—Ä–µ–º–µ–Ω–∏ —Å –∫–æ–º–ø–æ–∑–∏—Ü–∏–æ–Ω–Ω—ã–º —è–¥—Ä–æ–º ¬´—Ç—Ä–µ–Ω–¥ + –≥–ª–∞–¥–∫–æ—Å—Ç—å + –ø–µ—Ä–∏–æ–¥–∏–∫–∞¬ª, –ø–æ–∑–≤–æ–ª—è—é—â–∏–π –∏–∑–≤–ª–µ–∫–∞—Ç—å –∏ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å —Å–≥–ª–∞–∂–µ–Ω–Ω—ã–µ —Ü–∏–∫–ª—ã/–ø–æ–ª—É—Ü–∏–∫–ª—ã, —Ç–∏–ø–∏—á–Ω—ã–µ –¥–ª—è –¥–∏–Ω–∞–º–∏–∫–∏ –°–ö–†. –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —è–¥—Ä–∞ RationalQuadratic –∏ ExpSineSquared –≤ —Å—É–º–º–µ —Å –ª–∏–Ω–µ–π–Ω—ã–º —è–¥—Ä–æ–º DotProduct –∏ —à—É–º–æ–≤–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–π; –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —É—Å–ª–æ–≤–Ω–æ–µ —Å—Ä–µ–¥–Ω–µ–µ, –Ω–æ –∏ –¥–∏—Å–ø–µ—Ä—Å–∏—é, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø–æ –≥–æ–¥–∞–º. –¢–µ–æ—Ä–∏—è –∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è GPR, –∞ —Ç–∞–∫–∂–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∞—Ü–∏—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ —è–¥—Ä–∞ ExpSineSquared –¥–µ—Ç–∞–ª—å–Ω–æ –æ–ø–∏—Å–∞–Ω—ã –≤ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–µ scikit-learn; –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∫–ª–∞—Å—Å—É GaussianProcessRegressor –∏ —è–¥—Ä–∞–º —Å–ª—É–∂–∏—Ç –æ—Å–Ω–æ–≤–Ω—ã–º —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–º –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º. 
–í—Ç–æ—Ä–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç ‚Äî —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è –º–æ–¥–µ–ª—å –Ω–µ –Ω–∞–±–ª—é–¥–∞–µ–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç (Unobserved Components, UCM) —Å–æ —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–º –∑–∞—Ç—É—Ö–∞—é—â–∏–º —Ü–∏–∫–ª–æ–º –∏ –ª–æ–∫–∞–ª—å–Ω—ã–º —É—Ä–æ–≤–Ω–µ–º, –æ—Ü–µ–Ω–∏–≤–∞–µ–º–∞—è –≤ —Ñ–æ—Ä–º–∞—Ç–µ state space —Å —Ñ–∏–ª—å—Ç—Ä–æ–º –ö–∞–ª–º–∞–Ω–∞; –∏–º–µ–Ω–Ω–æ UCM –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫—É—é –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π —á–∞—Å—Ç–∏ –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —ç–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏—é –º–µ–¥–ª–µ–Ω–Ω—ã—Ö –∫–æ–ª–µ–±–∞–Ω–∏–π. –ö–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –∏ –æ–ø—Ü–∏–∏ –º–æ–¥–µ–ª–∏ (–≤–∫–ª—é—á–∞—è cycle, stochastic_cycle, damped_cycle) —Ñ–æ—Ä–º–∞–ª—å–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ statsmodels –∏ –≤–æ—Å—Ö–æ–¥—è—Ç –∫ –∫–ª–∞—Å—Å–∏–∫–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Ä—è–¥–æ–≤ –•–∞—Ä–≤–∏. 
3. –î–µ—Ç–∞–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏
–î–ª—è –∫–∞–∂–¥–æ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ i –Ω–∞–±–ª—é–¥–∞–µ—Ç—Å—è –≥–æ–¥–æ–≤–æ–π —Ä—è–¥ <span class="math">y<sub>i,t</sub></span> –Ω–∞ —Å–µ—Ç–∫–µ <span class="math">t</span> ‚àà {1990,‚Ä¶,2024}. –ì–∞—É—Å—Å–æ–≤ –ø—Ä–æ—Ü–µ—Å—Å –∑–∞–¥–∞—ë—Ç—Å—è –Ω—É–ª–µ–≤—ã–º —Å—Ä–µ–¥–Ω–∏–º –∏ —Å—É–º–º–æ–π —è–¥–µ—Ä <span class="math">k(t,t‚Ä≤)=k<sub>lin</sub>+k<sub>RQ</sub>+k<sub>per</sub>+k<sub>noise</sub></span>, –≥–¥–µ <span class="math">k<sub>lin</sub></span> ‚Äî DotProduct, <span class="math">k<sub>RQ</sub></span> ‚Äî RationalQuadratic (–º–Ω–æ–≥–æ—à–∫–∞–ª—å–Ω–∞—è –≥–ª–∞–¥–∫–æ—Å—Ç—å), <span class="math">k<sub>per</sub></span> ‚Äî ExpSineSquared —Å –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç—å—é –ø–æ—Ä—è–¥–∫–∞ 7‚Äì15
–ª–µ—Ç, –∫–æ—Ç–æ—Ä–∞—è —É—Ç–æ—á–Ω—è–µ—Ç—Å—è –ø–æ –º–∞–∫—Å–∏–º—É–º—É –º–∞—Ä–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è. –¢–∞–∫–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ø–æ–∑–≤–æ–ª—è–µ—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ –æ–ø–∏—Å—ã–≤–∞—Ç—å –º–µ–¥–ª–µ–Ω–Ω—ã–µ —Ç—Ä–µ–Ω–¥—ã, —Å–≥–ª–∞–∂–µ–Ω–Ω—É—é –Ω–µ—Ä–æ–≤–Ω–æ—Å—Ç—å –∏ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –∫–æ–ª–µ–±–∞–Ω–∏—è; —Ñ–æ—Ä–º—É–ª—ã –∏ —Å–≤–æ–π—Å—Ç–≤–∞ —è–¥–µ—Ä –ø—Ä–∏–≤–µ–¥–µ–Ω—ã –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏. 
–°—Ç—Ä—É–∫—Ç—É—Ä–Ω–∞—è –º–æ–¥–µ–ª—å –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ <span class="math">y<sub>i,t</sub>=Œº<sub>i,t</sub>+œà<sub>i,t</sub>+Œµ<sub>i,t</sub></span>, –≥–¥–µ <span class="math">Œº<sub>i,t</sub></span> ‚Äî –ª–æ–∫–∞–ª—å–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å (local level), <span class="math">œà<sub>i,t</sub></span> ‚Äî —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π –∑–∞—Ç—É—Ö–∞—é—â–∏–π —Ü–∏–∫–ª, <span class="math">Œµ<sub>i,t</sub>‚àºùí©(0,œÉ¬≤)</span>. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–º–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞–º–∏ UCM; –æ–ø—Ü–∏–∏ —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–Ω–æ—Å—Ç–∏ –∏ –¥–µ–º–ø—Ñ–∏—Ä–æ–≤–∞–Ω–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—Ç —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤—É statsmodels –∏ –º–æ–Ω–æ–≥—Ä–∞—Ñ–∏–∏ –•–∞—Ä–≤–∏. 
4. –û—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ, –≤–∞–ª–∏–¥–∞—Ü–∏—è –∏ –∞–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
–û—Ü–µ–Ω–∏–≤–∞–Ω–∏–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –ì–ü –ø—Ä–æ–≤–æ–¥–∏—Ç—Å—è –ø–æ –º–∞–∫—Å–∏–º—É–º—É –º–∞—Ä–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è —Å –ø–µ—Ä–µ–∫—Ä—ë—Å—Ç–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–æ–π, –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –∫ –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ä—è–¥–∞–º (TimeSeriesSplit): –æ–±—É—á–∞—é—â–∏–µ –±–ª–æ–∫–∏ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Ä–∞—Å—à–∏—Ä—è—é—Ç—Å—è, —Ç–µ—Å—Ç–æ–≤—ã–µ –±–ª–æ–∫–∏ —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω—ã –≤ –±—É–¥—É—â–µ–º –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –æ–±—É—á–∞—é—â–∏—Ö, —á—Ç–æ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç —É—Ç–µ—á–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏. –î–∞–Ω–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞ –æ–ø–∏—Å–∞–Ω—ã –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ scikit-learn. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä—è–¥–∞ —Å—Ç—Ä–æ–∏—Ç—Å—è –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ì–ü –Ω–∞ —Å–µ—Ç–∫–µ 1990‚Ä¶2100, –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∫–≤–∞–Ω—Ç–∏–ª–∏ <span class="math">p={2,5;10;50;90;97,5}</span>. –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –Ω–∞ —Ç–æ–º –∂–µ —Ä—è–¥—É –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è UCM, –æ—Ç–∫—É–¥–∞ –∏–∑–≤–ª–µ–∫–∞–µ—Ç—Å—è —Ç–æ—á–µ—á–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –º–µ–¥–∏–∞–Ω–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è. –î–∞–ª–µ–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –≤–∑–≤–µ—à–µ–Ω–Ω–∞—è –º–µ–¥–∏–∞–Ω–∞: –Ω–∞ –±–ª–∏–∂–Ω–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ –¥–æ –æ–ø–æ—Ä–Ω–æ–≥–æ –≥–æ–¥–∞ <span class="math">T<sub>blend</sub></span> –±–æ–ª—å—à–∏–π –≤–µ—Å –ø–æ–ª—É—á–∞–µ—Ç –ì–ü (—á—Ç–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —ç–º–ø–∏—Ä–∏—á–µ—Å–∫—É—é –≤–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–µ—Ç), –ø–æ—Å–ª–µ —á–µ–≥–æ –≤–µ—Å –ø–ª–∞–≤–Ω–æ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∫ —É—Å—Ä–µ–¥–Ω–µ–Ω–∏—é –ì–ü –∏ UCM; –ø–µ—Ä–µ—Ö–æ–¥ –∑–∞–¥–∞—ë—Ç—Å—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ–π –≤–µ—Å–æ–≤–æ–π —Ñ—É–Ω–∫—Ü–∏–µ–π –ø–æ –≥–æ–¥–∞–º –ø—Ä–æ–≥–Ω–æ–∑–∞. –¢–∞–∫–∞—è –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—é –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å —Ü–∏–∫–ª–æ–≤. –î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –Ω–µ—Ñ–∏–∑–∏–æ–ª–æ–≥–∏—á–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –Ω–∞ –¥–∞–ª—å–Ω–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –º—è–≥–∫–∞—è —Ü–µ–Ω–∑—É—Ä–∞, –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏: –Ω–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ <span class="math">max(0,5, min(y) ‚àí 0,25)</span>, –≤–µ—Ä—Ö–Ω—è—è <span class="math">min(5,0, max(y) + 0,75)</span>.
–û—Ç–¥–µ–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–æ–Ω—Ç—Ä–æ–ª—å –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç–∏: –¥–ª—è –±–ª–∏–∂–∞–π—à–µ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è, —á—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –º–µ–¥–∏–∞–Ω–Ω–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –ø–æ –≥–æ–¥–∞–º –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ; –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –ø–∞—Ç–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ ¬´–ø–ª–æ—Å–∫–∏—Ö¬ª —Å–µ–≥–º–µ–Ω—Ç–æ–≤ –∏–Ω–∏—Ü–∏–∏—Ä—É–µ—Ç –ø–µ—Ä–µ—Å–º–æ—Ç—Ä —Å–µ—Ç–∫–∏ –ø–µ—Ä–∏–æ–¥–æ–≤ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–æ–≥–æ —è–¥—Ä–∞, —á—Ç–æ –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏—á–µ—Å–∫–∏ —Å–æ–≥–ª–∞—Å—É–µ—Ç—Å—è —Å –ø—Ä–∞–∫—Ç–∏–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GP-—è–¥–µ—Ä –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö —Ü–∏–∫–ª–æ–≤. –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –æ—Å–Ω–æ–≤–∞–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∑–∞–¥–∞–Ω—ã –≤ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞—Ö scikit-learn –∏ statsmodels –∏ –≤ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –ø–æ GP –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–º –º–æ–¥–µ–ª—è–º. 
5. –†–∞–∑–ª–∏—á–∏—è —Å –±–∞–π–µ—Å–æ–≤—Å–∫–æ–π –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–µ–π –û–û–ù –∏ –º–æ—Ç–∏–≤–∞—Ü–∏—è –≤—ã–±–æ—Ä–∞
–ë–∞–π–µ—Å–æ–≤—Å–∫–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –û–û–ù (bayesTFR) –≤ –ø–æ—Å—Ç—Ç—Ä–∞–Ω–∑–∏—Ç–Ω–æ–π —Ñ–∞–∑–µ –∞–ø—Ä–∏–æ—Ä–Ω–æ –º–æ–¥–µ–ª–∏—Ä—É–µ—Ç —Ñ–ª—É–∫—Ç—É–∞—Ü–∏–∏ –≤–æ–∫—Ä—É–≥ —É—Ä–æ–≤–Ω—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞ –∏ –Ω–∞ –¥–ª–∏–Ω–Ω–æ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ –∏–º–µ–µ—Ç –≤–æ—Å—Ö–æ–¥—è—â–∏–π –¥—Ä–µ–π—Ñ –º–µ–¥–∏–∞–Ω—ã –∫ ‚âà2,1; –≤ —É—Å–ª–æ–≤–∏—è—Ö –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –ª–µ—Ç —Å –ø–∞–¥–µ–Ω–∏–µ–º –°–ö–† —ç—Ç–æ –¥–∞—ë—Ç —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—ä—ë–º –±–ª–∏–∂–∞–π—à–∏—Ö –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∏ —Å—à–∏–≤–∫–µ –Ω–∞ 2022‚Äì2023 –≥–æ–¥–∞—Ö –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞. –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω–∞—è –∑–¥–µ—Å—å ML-—Å—Ö–µ–º–∞ –Ω–µ –Ω–∞–≤—è–∑—ã–≤–∞–µ—Ç –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏—é –∫ replacement, –¥–æ–ø—É—Å–∫–∞–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –Ω–∏—Å—Ö–æ–¥—è—â–∏—Ö –≤–æ–ª–Ω –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —É–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≥–ª–∞–¥–∫–æ—Å—Ç—å –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∏—Ä—É–µ–º–æ—Å—Ç—å —Ü–∏–∫–ª–æ–≤ —á–µ—Ä–µ–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç. –≠—Ç–æ –∏ —Å—Ç–∞–ª–æ –ø—Ä–∏—á–∏–Ω–æ–π –≤—ã–±–æ—Ä–∞ –≥–∏–±—Ä–∏–¥–Ω–æ–π GP+UCM –¥–ª—è –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –ø—Ä–∏–∫–ª–∞–¥–Ω–æ–π –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∏; —Ñ–æ—Ä–º–∞–ª—å–Ω—ã–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –º–æ–¥–µ–ª–µ–π –∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –¥–æ—Å—Ç—É–ø–Ω—ã –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ —É–ø–æ–º—è–Ω—É—Ç—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ –∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö. 
6. –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å –∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ —Ä–µ–∞–ª–∏–∏
–†–∞—Å—á—ë—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –≤ Google Colab –Ω–∞ Python. –î–ª—è –ì–ü –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω—ã GaussianProcessRegressor –∏ —è–¥—Ä–∞ RationalQuadratic, ExpSineSquared, DotProduct, WhiteKernel; –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω–æ–π –º–æ–¥–µ–ª–∏ ‚Äî statsmodels.tsa.statespace.structural.UnobservedComponents. –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —Å –ø–æ–º–æ—â—å—é TimeSeriesSplit –±–µ–∑ –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏—è, –∫–∞–∫ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω random_state=42 –ø—Ä–∏ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤; –ø–æ–ª—É—á–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã —Å —Ç–æ—á–Ω–æ—Å—Ç—å—é –¥–æ —á–∏—Å–ª–µ–Ω–Ω–æ–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏. –ü–æ–¥—Ä–æ–±–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ API –∏ —Å–≤–æ–π—Å—Ç–≤ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–ª–∞—Å—Å–æ–≤ –ø—Ä–∏–≤–µ–¥–µ–Ω–æ –≤ –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ scikit-learn –∏ statsmodels. 
7. –†–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–µ —Ñ–∞–π–ª—ã –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø–æ–ª–µ–π
–ò—Ç–æ–≥–æ–≤–∞—è –≤—ã–≥—Ä—É–∑–∫–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –¥–≤—É—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö. –ü–µ—Ä–≤–∞—è ‚Äî ¬´tidy¬ª-–±–∞–∑–∞, –≥–¥–µ –∫–∞–∂–¥–∞—è –∑–∞–ø–∏—Å—å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ–π –ø–∞—Ä–µ ¬´—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è‚Äì–≥–æ–¥¬ª, —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–æ–ª—è–º–∏: ¬´–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è¬ª (—Å—Ç—Ä–æ–≥–æ –∏–∑ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞), ¬´–ì–æ–¥¬ª (1990‚Äì2100), ¬´median¬ª (–º–µ–¥–∏–∞–Ω–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑ –∏–ª–∏ –Ω–∞–±–ª—é–¥–∞–µ–º–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏), ¬´q10¬ª, ¬´q90¬ª, ¬´q2_5¬ª, ¬´q97_5¬ª (–≥—Ä–∞–Ω–∏—Ü—ã 80% –∏ 95% –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –∏–∑ –ì–ü), ¬´–°—Ç–∞—Ç—É—Å¬ª (¬´–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ¬ª –¥–ª—è 1990‚Äì–ø–æ—Å–ª–µ–¥–Ω–∏–π –≥–æ–¥ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –≤–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ; ¬´–ø—Ä–æ–≥–Ω–æ–∑¬ª –¥–ª—è –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö –ª–µ—Ç –¥–æ 2100). –í—Ç–æ—Ä–∞—è ‚Äî ¬´wide¬ª-–±–∞–∑–∞, –≥–¥–µ –ø–æ —Å—Ç—Ä–æ–∫–∞–º –≥–æ–¥—ã, –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏; —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏—Å—Ç ¬´median¬ª (–º–∞—Ç—Ä–∏—Ü–∞ –º–µ–¥–∏–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π) –∏ –ª–∏—Å—Ç ¬´status¬ª (–º–∞—Ç—Ä–∏—Ü–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ ¬´–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ/–ø—Ä–æ–≥–Ω–æ–∑¬ª). –ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ –≤ –ø–æ—Å—Ç–∞–≤–∫–µ —Å–ª–µ–¥—É—é—â–∏–µ: ¬´TFR_Russia_subjects_ML_GP_UCM_tidy.csv¬ª –∏ ¬´TFR_Russia_subjects_ML_GP_UCM_tidy.xlsx¬ª (–±–∞–∑–∞ –≤ –¥–ª–∏–Ω–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ) –∏ ¬´TFR_Russia_subjects_ML_GP_UCM_wide.xlsx¬ª (—à–∏—Ä–æ–∫–∏–π —Ñ–æ—Ä–º–∞—Ç). –≠—Ç–∏ —Ñ–∞–π–ª—ã –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω—ã –ø–æ –≥–æ–¥–∞–º –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è–º, –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤ –≤ –ø—Ä–æ–≥–Ω–æ–∑–Ω–æ–π —á–∞—Å—Ç–∏ –∏ –≥–æ—Ç–æ–≤—ã –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ –≤–∏—Ç—Ä–∏–Ω—ã.
8. –ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑–≤–∏—Ç–∏—è
–ú–µ–¥–∏–∞–Ω–Ω—ã–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –æ—Å–Ω–æ–≤–∞–Ω—ã –Ω–∞ –ì–ü-–ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–∏ –Ω–æ—Ä–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥–∏–∫—Ç–∏–≤–Ω–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è; –≤ —É–∑–∫–∏—Ö –≤—ã–±–æ—Ä–∫–∞—Ö —Å —Å–∏–ª—å–Ω—ã–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–º–∏ —Å–¥–≤–∏–≥–∞–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º –º–æ–∂–µ—Ç –ø–æ—Ç—Ä–µ–±–æ–≤–∞—Ç—å—Å—è —É—Ç–æ—á–Ω–µ–Ω–∏–µ –Ω–∞ –æ—Å–Ω–æ–≤–µ –±—É—Ç—Å—Ç—Ä–µ–ø-—Å–∏–º—É–ª—è—Ü–∏–π –∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç UCM –∏–¥–µ–Ω—Ç–∏—Ñ–∏—Ü–∏—Ä—É–µ—Ç –æ–¥–∏–Ω –∑–∞—Ç—É—Ö–∞—é—â–∏–π —Ü–∏–∫–ª; –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —á–∞—Å—Ç–æ—Ç–Ω—ã—Ö –º–æ–¥ –º–æ–∂–µ—Ç –ø–æ–Ω–∞–¥–æ–±–∏—Ç—å—Å—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–≥–æ –±–ª–æ–∫–∞. –ü—Ä–∏ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏ (ASFR) –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –∫ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ-–¥–∞–Ω–Ω—ã–º –º–æ–¥–µ–ª—è–º —Å –∫–æ–≥–µ—Ä–µ–Ω—Ç–Ω–æ—Å—Ç—å—é –ø–æ —Å—É–±–ø–æ–ø—É–ª—è—Ü–∏—è–º; –≤ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ ASFR —Ç–µ–∫—É—â–∞—è –ø–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç—Ä–µ–±—É–µ–º—É—é –≤–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω–æ—Å—Ç—å –Ω–∞ –≥–æ–¥–æ–≤–æ–π —à–∫–∞–ª–µ –ø—Ä–∏ —Å—Ç—Ä–æ–≥–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–µ –≥–ª–∞–¥–∫–æ—Å—Ç–∏ –∏ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è —É—Ä–æ–≤–Ω–µ–π. –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∏–µ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–µ –æ—Å–Ω–æ–≤–∞–Ω–∏—è –ø—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ –∑–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–∞—Ö –∏ –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–º –º–æ–¥–µ–ª—è–º –∏ –≥–∞—É—Å—Å–æ–≤—ã–º –ø—Ä–æ—Ü–µ—Å—Å–∞–º. </pre>
      </details>
      <details>
        <summary>–û–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∂–∏–∑–Ω–∏</summary>
        <pre class="method-text">–ü—Ä–æ–≥–Ω–æ–∑ –æ–∂–∏–¥–∞–µ–º–æ–π –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∂–∏–∑–Ω–∏ –ø—Ä–∏ —Ä–æ–∂–¥–µ–Ω–∏–∏ –¥–æ 2100 –≥–æ–¥–∞ 
(–†–æ—Å—Å–∏–π—Å–∫–∞—è –§–µ–¥–µ—Ä–∞—Ü–∏—è, —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã–µ –æ–∫—Ä—É–≥–∞, –≤—Å–µ —Å—É–±—ä–µ–∫—Ç—ã; –ø–æ –ø–æ–ª—É: –∂–µ–Ω—â–∏–Ω—ã, –º—É–∂—á–∏–Ω—ã)
–ü–æ–ª–Ω–∞—è –±–∞–∑–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –≤ –ë–î-—Ñ–æ—Ä–º–∞—Ç–µ –∏ –≤ —à–∏—Ä–æ–∫–æ–º —Ñ–æ—Ä–º–∞—Ç–µ, –¥–æ–±–∞–≤–ª–µ–Ω –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Ñ–∞–π–ª —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –º–æ–¥–µ–ª–∏ –ø–æ –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–µ. –§–∞–π–ª—ã:
–ë–î-–≤–µ—Ä—Å–∏—è (–≤—Å–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –∏ –ø—Ä–æ–≥–Ω–æ–∑—ã –Ω–∞ –∫–∞–∂–¥—ã–π –≥–æ–¥, –±–µ–∑ –ø—Ä–æ–ø—É—Å–∫–æ–≤): LE_Russia_subjects_forecast_2100_long.xlsx, CSV
–®–∏—Ä–æ–∫–∏–π —Ñ–æ—Ä–º–∞—Ç (–ª–∏—Å—Ç values ‚Äî –∑–Ω–∞—á–µ–Ω–∏—è, –ª–∏—Å—Ç status ‚Äî —Å—Ç–∞—Ç—É—Å ¬´–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ/–ø—Ä–æ–≥–Ω–æ–∑¬ª): LE_Russia_subjects_forecast_2100_wide.xlsx
–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (—è–∫–æ—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å <span class="math">y<sub>0</sub></span>, –æ—Ü–µ–Ω—ë–Ω–Ω—ã–π –¥–æ–∫–æ–≤–∏–¥–Ω—ã–π –Ω–∞–∫–ª–æ–Ω <span class="math">s<sub>0</sub></span>, –∞—Å–∏–º–ø—Ç–æ—Ç–∞ <span class="math">L</span>, —Å–∫–æ—Ä–æ—Å—Ç—å –∑–∞—Ç—É—Ö–∞–Ω–∏—è <span class="math">k</span>, –≥–æ–¥ —è–∫–æ—Ä—è): LE_Russia_subjects_forecast_2100_diagnostics.csv
–í –∫–∞—á–µ—Å—Ç–≤–µ –æ—Å–Ω–æ–≤—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–∞—è –ø–æ –≤—Å–µ–º —Å—Ç—Ä–æ–∫–∞–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–∞—è —ç–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏—è. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∞–ª—å–Ω–æ-–ø–æ–ª–æ–≤–æ–≥–æ —Ä—è–¥–∞ –±–µ—Ä—ë—Ç—Å—è —è–∫–æ—Ä–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å <span class="math">y<sub>0</sub></span> –∑–∞ 2023 –≥–æ–¥ –∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç—Å—è —Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–∏—Ä–æ—Å—Ç–∞ <span class="math">s<sub>0</sub></span> –Ω–∞ –¥–æ–∫–æ–≤–∏–¥–Ω–æ–º —É—á–∞—Å—Ç–∫–µ —É—Å—Ç–æ–π—á–∏–≤–æ–≥–æ —Ä–æ—Å—Ç–∞ 2004‚Äì2019 –≥–≥. –ø—Ä–æ—Å—Ç–µ–π—à–µ–π OLS-—Ä–µ–≥—Ä–µ—Å—Å–∏–µ–π <span class="math">y<sub>t</sub>=Œ±+Œ≤t</span> –ø—Ä–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–∏ 2020‚Äì2021 –≥–≥. –∫–∞–∫ —ç–∫–∑–æ–≥–µ–Ω–Ω–æ–≥–æ —à–æ–∫–∞; –ø—Ä–∏ –¥–µ—Ñ–∏—Ü–∏—Ç–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –∑–∞–¥–µ–π—Å—Ç–≤—É—é—Ç—Å—è —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –æ–∫–Ω–∞ –∏, –≤ –∫—Ä–∞–π–Ω–µ–º —Å–ª—É—á–∞–µ, –Ω–∞—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π ¬´–±–µ–Ω—á–º–∞—Ä–∫¬ª-–Ω–∞–∫–ª–æ–Ω. –î–∞–ª—å–Ω–µ–π—à–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è —Å—Ç—Ä–æ–∏—Ç—Å—è –ø–æ —Ñ–æ—Ä–º—É–ª–µ
<span class="math">y(t)=L‚àí(L‚àíy<sub>0</sub>)¬∑e^{‚àík¬∑(t‚àí2023)}</span>, <span class="math">k = s<sub>0</sub>/(L‚àíy<sub>0</sub>)</span>, <span class="math">t ‚â• 2023</span>,
—á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –º–æ–Ω–æ—Ç–æ–Ω–Ω—ã–π —Ä–æ—Å—Ç –∏ –¥–µ–º–ø—Ñ–∏—Ä–æ–≤–∞–Ω–∏–µ –∫ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–º –ø–æ—Ç–æ–ª–∫–∞–º –±–µ–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –Ω–µ–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–π –ª–∏–Ω–µ–π–Ω–æ–π —ç–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏–∏. –í–µ—Ä—Ö–Ω–∏–µ –ø—Ä–µ–¥–µ–ª—ã –∑–∞–¥–∞–Ω—ã —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ –ø–æ –ø–æ–ª—É: –¥–ª—è –∂–µ–Ω—â–∏–Ω <span class="math">L=92</span>, –¥–ª—è –º—É–∂—á–∏–Ω <span class="math">L=88</span> –ª–µ—Ç; –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä—è–¥–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è
<span class="math">L>y<sub>0</sub></span>. –ò—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è 1990‚Äì2023 –≥–≥. —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –≤–∏–¥–µ, –∞ —Å—Ç–∞—Ç—É—Å ¬´–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ/–ø—Ä–æ–≥–Ω–æ–∑¬ª —è–≤–Ω–æ –ø–æ–º–µ—á–µ–Ω –≤ –≤—ã–¥–∞—á–µ.
–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –≥–æ–¥–æ–≤–æ–π —Ä—è–¥ 1990‚Äì2100 –¥–ª—è –∫–∞–∂–¥–æ–π —Å—Ç—Ä–æ–∫–∏ –∏—Å—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞; –≤ ¬´tidy¬ª-–≤–µ—Ä—Å–∏–∏ –ø–æ–ª—è: ¬´–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è¬ª, ¬´–ü–æ–ª¬ª, ¬´–ì–æ–¥¬ª, ¬´e0¬ª, ¬´–°—Ç–∞—Ç—É—Å¬ª. –ï—Å–ª–∏ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è, –º–æ–≥—É –æ–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–º–∏ –ø–æ—Ç–æ–ª–∫–∞–º–∏ L (–∫–æ–Ω—Å–µ—Ä–≤–∞—Ç–∏–≤–Ω—ã–π/–æ–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–π), –¥–æ–±–∞–≤–∏—Ç—å –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã (–±—É—Ç—Å—Ç—Ä–µ–ø –≤–æ–∫—Ä—É–≥ –ª–æ–≥–∏—Å—Ç–∏–∫–∏) –ª–∏–±–æ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞—Ç—å –ø–æ –ø–æ–ª—É –≤ ¬´–æ–±–∞ –ø–æ–ª–∞¬ª –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã—Ö –≤–µ—Å–æ–≤.</pre>
      </details>
      <details>
        <summary>–ú–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–∏—Ç–æ–∫, –æ—Ç—Ç–æ–∫ –∏ —Å–∞–ª—å–¥–æ</summary>
        <pre class="method-text">–ú–µ—Ç–æ–¥–∏–∫–∞ –ø—Ä–æ–≥–Ω–æ–∑–∞ –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –ø—Ä–∏—Ç–æ–∫–∞, –æ—Ç—Ç–æ–∫–∞ –∏ —Å–∞–ª—å–¥–æ –¥–æ 2100 –≥–æ–¥–∞
(–†–æ—Å—Å–∏–π—Å–∫–∞—è –§–µ–¥–µ—Ä–∞—Ü–∏—è, —Å—É–±—ä–µ–∫—Ç—ã –†–§; –ø–æ –ø–æ–ª—É: –º—É–∂—á–∏–Ω—ã, –∂–µ–Ω—â–∏–Ω—ã, –≤—Å–µ–≥–æ)
1. –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –ø—Ä–µ–¥–ø–æ—Å—ã–ª–∫–∏
–ò—Å—Ö–æ–¥–Ω—ã–º–∏ —è–≤–ª—è—é—Ç—Å—è –∫–Ω–∏–≥–∏ –†–æ—Å—Å—Ç–∞—Ç–∞ ¬´–ß–∏—Å–ª–æ –ø—Ä–∏–±—ã–≤—à–∏—Ö –ø–æ –ø–æ–ª—É‚Ä¶¬ª –∏ ¬´–ß–∏—Å–ª–æ –≤—ã–±—ã–≤—à–∏—Ö –ø–æ –ø–æ–ª—É‚Ä¶¬ª –∑–∞ 2017‚Äì2023 –≥–æ–¥—ã –≤ —Ñ–æ—Ä–º–µ –≥–æ–¥–æ–≤—ã—Ö —Å—á—ë—Ç–Ω—ã—Ö –≤–µ–ª–∏—á–∏–Ω –ø–æ —Å—É–±—ä–µ–∫—Ç–∞–º –†–§. –í –∫–Ω–∏–≥–∞—Ö –≤–æ–∑–º–æ–∂–Ω—ã –¥–≤–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—ë–Ω–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞: ¬´—É–∑–µ–ª¬ª –ø–æ–ª–∞ ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è –∫–æ–ª–æ–Ω–∫–∞, –ª–∏–±–æ –ø–æ–ª –∑–∞—à–∏—Ç –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –≥–æ–¥–æ–≤—ã—Ö —Å—Ç–æ–ª–±—Ü–æ–≤. –ü–∞—Ä—Å–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞—ë—Ç –æ–±–∞ –≤–∞—Ä–∏–∞–Ω—Ç–∞, –Ω–æ—Ä–º–∞–ª–∏–∑—É–µ—Ç –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏—è —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π –∏ –∏–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏—è –ø–æ –º—É–∂—á–∏–Ω–∞–º –∏ –ø–æ –∂–µ–Ω—â–∏–Ω–∞–º. –ü–µ—Ä–∏–æ–¥ 2017‚Äì2023 —Ç—Ä–∞–∫—Ç—É–µ—Ç—Å—è –∫–∞–∫ —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∏ –≤ —Ç–æ—á–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –≤ –≤—ã–ø—É—Å–∫–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã; –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–∞–∫—Ç–∞ –Ω–µ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è.
–ü—Ä–æ–≥–Ω–æ–∑ —Å—Ç—Ä–æ–∏—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã ¬´—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è √ó –ø–æ–ª¬ª –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ, –∑–∞—Ç–µ–º —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –∞–≥—Ä–µ–≥–∞—Ç ¬´–≤—Å–µ–≥–æ¬ª –ø—Ä–æ—Å—Ç—ã–º —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–æ–ª–æ–≤. –ì–æ–¥—ã –ø–æ—Å–ª–µ 2023 –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –ø—Ä–æ–≥–Ω–æ–∑–Ω–æ–º—É –≥–æ—Ä–∏–∑–æ–Ω—Ç—É –∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç—Å—è –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω–æ –¥–æ 2100 –≥–æ–¥–∞.
2. –ö–æ–Ω—Ü–µ–ø—Ü–∏—è –º–æ–¥–µ–ª–∏
–ú–æ–¥–µ–ª—å –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Ç—Ä–∏ –∫–ª—é—á–µ–≤—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞: —Ü–∏–∫–ª–∏—á–µ—Å–∫—É—é –∞–ø–ø—Ä–æ–∫—Å–∏–º–∞—Ü–∏—é –≥–æ–¥–æ–≤–æ–π –¥–∏–Ω–∞–º–∏–∫–∏ –ø—Ä–∏—Ç–æ–∫–∞ –∏ –æ—Ç—Ç–æ–∫–∞, –º—è–≥–∫—É—é –≥–∏–ø–æ—Ç–µ–∑—É —Ä–æ—Å—Ç–∞ ¬´–º–æ–±–∏–ª—å–Ω–æ—Å—Ç–∏¬ª –Ω–∞—Å–µ–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç –æ–±–æ—Ä–æ—Ç–∞ –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—é —Å–∞–ª—å–¥–æ –≤ –¥–∞–ª—å–Ω–µ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ; –≤—Å–µ —Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ç–∞–∫, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –≤–∏–¥–∏–º—ã–µ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –≤–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º—ã –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏—Å–∫–ª—é—á–∏—Ç—å –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –≤—Å–ø–ª–µ—Å–∫–∏.
–í–æ-–ø–µ—Ä–≤—ã—Ö, –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä—è–¥–∞ <span class="math">y<sub>t</sub></span> (–ø—Ä–∏—Ç–æ–∫ <span class="math">I<sub>t</sub></span> –∏–ª–∏ –æ—Ç—Ç–æ–∫ <span class="math">O<sub>t</sub></span>) –Ω–∞ –∏–Ω—Ç–µ—Ä–≤–∞–ª–µ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ª–∏–Ω–µ–π–Ω–æ-–≥–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è
<span class="math">≈∑<sub>t</sub>=a+b¬∑(t‚àít<sub>0</sub>)+c¬∑sin(2œÄ(t‚àít<sub>0</sub>)/P)+d¬∑cos(2œÄ(t‚àít<sub>0</sub>)/P)</span>
–ü–µ—Ä–∏–æ–¥ <span class="math">P</span> –ø–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è –ø–µ—Ä–µ–±–æ—Ä–æ–º –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ <span class="math">{3,4,5,6,7,8}</span> –ø–æ –º–∏–Ω–∏–º—É–º—É —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–æ–π –æ—à–∏–±–∫–∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–º —É—á–∞—Å—Ç–∫–µ, —á—Ç–æ –¥–∞—ë—Ç —É—Å—Ç–æ–π—á–∏–≤—É—é —Å—Ä–µ–¥–Ω–µ—Å—Ä–æ—á–Ω—É—é –≤–æ–ª–Ω—É –±–µ–∑ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö —Ä—è–¥–∞—Ö. –ï—Å–ª–∏ –æ—Ü–µ–Ω—ë–Ω–Ω—ã–π –ª–∏–Ω–µ–π–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç b<0, –æ–Ω –æ–±–Ω—É–ª—è–µ—Ç—Å—è –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∞, —Ç–µ–º —Å–∞–º—ã–º –∏—Å–∫–ª—é—á–∞—è —Å–∏—Å—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–±—ã–≤–∞–Ω–∏–µ ¬´–º–æ–±–∏–ª—å–Ω–æ—Å—Ç–∏¬ª (—Å–º. –ø—É–Ω–∫—Ç 3). –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∞—è –∞–º–ø–ª–∏—Ç—É–¥–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è —Å–≤–µ—Ä—Ö—É –¥–æ–ª–µ–π —Å—Ä–µ–¥–Ω–µ–≥–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å ¬´—Ä–∞–∑–Ω–æ—Å¬ª –æ—Ç –ø–æ–¥–≥–æ–Ω–∫–∏.
–í–æ-–≤—Ç–æ—Ä—ã—Ö, –Ω–∞ —ç—Ç–∞–ø–∞—Ö —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏—è –±—É–¥—É—â–∏—Ö —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–π –ø—Ä–∏—Ç–æ–∫–∞ –∏ –æ—Ç—Ç–æ–∫–∞ –≤–≤–æ–¥–∏—Ç—Å—è –≥–∏–ø–æ—Ç–µ–∑–∞ —Å–ª–∞–±–æ–≥–æ —Ä–æ—Å—Ç–∞ –æ–±–æ—Ä–æ—Ç–∞ <span class="math">T<sub>t</sub>=I<sub>t</sub>+O<sub>t</sub></span> –∫–∞–∫ –ø—Ä–æ–∫—Å–∏ ¬´–∏–Ω—Ç–µ–Ω—Å–∏–≤–Ω–æ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ –æ–±–º–µ–Ω–∞¬ª. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ—Å–ª–µ–¥—É—é—â–µ–≥–æ –≥–æ–¥–∞ —Ç—Ä–µ–±—É–µ–º—ã–π –æ–±–æ—Ä–æ—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∏–∂–µ, —á–µ–º –æ–±–æ—Ä–æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –≥–æ–¥–∞ –ø–ª—é—Å –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø—Ä–∏–±–∞–≤–∫–∞, –ø—Ä–æ–ø–æ—Ä—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å—Ä–µ–¥–Ω–µ–º—É –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–º—É –æ–±–æ—Ä–æ—Ç—É (–≤ –±–∞–∑–æ–≤–æ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ ‚Äî –Ω–µ –º–µ–Ω–µ–µ 0,5% —Å—Ä–µ–¥–Ω–µ–≥–æ –≤ –≥–æ–¥). –≠—Ç–æ –≤–≤–æ–¥–∏—Ç –º—è–≥–∫—É—é –∏ –º–æ–Ω–æ—Ç–æ–Ω–Ω—É—é ¬´—Å—Ç—Ä–æ–ø—É¬ª –¥–ª—è <span class="math">T<sub>t</sub></span>, —É—Ä–∞–≤–Ω–æ–≤–µ—à–∏–≤–∞—é—â—É—é –≤–æ–ª–Ω—ã –±–µ–∑ –ª–∏–Ω–µ–π–Ω–æ–≥–æ ¬´–∑–∞–≥–ª–∞–∂–∏–≤–∞–Ω–∏—è¬ª.
–í-—Ç—Ä–µ—Ç—å–∏—Ö, –¥–ª—è —Å–∞–ª—å–¥–æ <span class="math">N<sub>t</sub>=I<sub>t</sub>‚àíO<sub>t</sub></span> –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –ø—Ä–∏–Ω—Ü–∏–ø ¬´–∫–æ–Ω—É—Å–∞ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–∏—è¬ª –Ω–∞ –≤—Å—ë–º –ø—Ä–æ–≥–Ω–æ–∑–Ω–æ–º –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ: –¥–æ–ø—É—Å—Ç–∏–º—ã–π –∫–æ—Ä–∏–¥–æ—Ä <span class="math">[LB,UB]</span> –∑–∞–¥–∞—ë—Ç—Å—è –∫–∞–∫ ¬±50% –æ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞ <span class="math">[min N<sub>t</sub>, max N<sub>t</sub>]</span> –ø–µ—Ä–∏–æ–¥–∞ 2017‚Äì2023. –í–º–µ—Å—Ç–æ –ø–æ—ç–ª–µ–º–µ–Ω—Ç–Ω–æ–≥–æ –æ–±—Ä–µ–∑–∞–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫ ¬´–ø—Ä–∏–ª–∏–ø–∞–Ω–∏—é¬ª –∫ –≥—Ä–∞–Ω–∏—Ü–µ, –≤—Å—è –±—É–¥—É—â–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è ¬´—Å—ã—Ä–æ–≥–æ¬ª —Å–∞–ª—å–¥–æ <span class="math">N<sup>raw</sup><sub>t</sub></span> –∞—Ñ—Ñ–∏–Ω–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –∫ –∏–Ω—Ç–µ—Ä–≤–∞–ª—å–Ω–æ–º—É –∫–æ—Ä–∏–¥–æ—Ä—É –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ —Ü–µ–Ω—Ç—Ä–∞ (—Å—Ä–µ–¥–Ω–µ–≥–æ <span class="math">N</span>). –¢–µ–º —Å–∞–º—ã–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è —Ñ–æ—Ä–º–∞ –∏ —Ñ–∞–∑–∞ –∫–æ–ª–µ–±–∞–Ω–∏–π, –Ω–æ –∏—Å–∫–ª—é—á–∞–µ—Ç—Å—è –≤—ã—Ö–æ–¥ –∑–∞ –ø—Ä–µ–¥–µ–ª—ã [LB,UB]. –í —Ä–µ–¥–∫–∏—Ö —Å–ª—É—á–∞—è—Ö, –∫–æ–≥–¥–∞ –ø–æ—Å–ª–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è —Ä—è–¥ –æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑–ª–∏—à–Ω–µ ¬´–ø–ª–æ—Å–∫–∏–º¬ª, –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω–∞—è ¬´—Ä–∏—Ñ–ª—ë–Ω–æ—Å—Ç—å¬ª —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ñ–∞–∑—ã –∏ –º–∞–ª–æ–π –∞–º–ø–ª–∏—Ç—É–¥—ã (–¥–µ—Å—è—Ç–∞—è –¥–æ–ª—è —à–∏—Ä–∏–Ω—ã –∫–æ—Ä–∏–¥–æ—Ä–∞), —Å—Ç—Ä–æ–≥–æ –æ—Å—Ç–∞—é—â–∞—è—Å—è –≤–Ω—É—Ç—Ä–∏ [LB,UB]. –≠—Ç–æ—Ç —à–∞–≥ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –∫–æ–Ω—Å—Ç–∞–Ω—Ç–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã–µ —Å–∞–ª—å–¥–æ, –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ —Ä–∞–Ω–µ–µ –Ω–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è—Ö –ø—Ä–∏ –∂—ë—Å—Ç–∫–æ–º –∫–ª–∏–ø–µ.
–ü–æ—Å–ª–µ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏—è —Ü–µ–ª–µ–≤–æ–≥–æ –æ–±–æ—Ä–æ—Ç–∞ <span class="math">T<sub>t</sub></span> –∏ —Å–∞–ª—å–¥–æ <span class="math">N<sub>t</sub></span> –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω—ã–µ —Ä—è–¥—ã <span class="math">I<sub>t</sub>=(T<sub>t</sub>+N<sub>t</sub>)/2</span> –∏ <span class="math">O<sub>t</sub>=(T<sub>t</sub>‚àíN<sub>t</sub>)/2</span> —Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–π –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é, –∑–∞—Ç–µ–º –æ–∫—Ä—É–≥–ª—è—é—Ç—Å—è –¥–æ —Ü–µ–ª—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π.
3. –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏ –ø—Ä–µ–¥–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª–∏
–ü–µ—Ä–∏–æ–¥ –≥–∞—Ä–º–æ–Ω–∏–∫–∏ <span class="math">P</span> –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –ø–µ—Ä–µ–±–æ—Ä–æ–º —Å –∫—Ä–∏—Ç–µ—Ä–∏–µ–º MSE; –ª–∏–Ω–µ–π–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç <span class="math">b</span> –≤ –ø—Ä–æ–≥–Ω–æ–∑–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è —Å–Ω–∏–∑—É –Ω—É–ª—ë–º, —á—Ç–æ –æ—Ç—Ä–∞–∂–∞–µ—Ç –≥–∏–ø–æ—Ç–µ–∑—É –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è —Å–µ–∫—É–ª—è—Ä–Ω–æ–≥–æ —Å–Ω–∏–∂–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–π –º–æ–±–∏–ª—å–Ω–æ—Å—Ç–∏. –ì–∞—Ä–º–æ–Ω–∏—á–µ—Å–∫–∏–µ –∞–º–ø–ª–∏—Ç—É–¥—ã –ø—Ä–∏—Ç–æ–∫–∞ –∏ –æ—Ç—Ç–æ–∫–∞ –∫–∞–ø–∏—Ä—É—é—Ç—Å—è –¥–æ–ª–µ–π –æ—Ç —Å—Ä–µ–¥–Ω–µ–≥–æ —É—Ä–æ–≤–Ω—è —Ä—è–¥–∞; –≤ –±–∞–∑–æ–≤–æ–π –∫–∞–ª–∏–±—Ä–æ–≤–∫–µ –≤–µ—Ä—Ö–Ω–∏–π –ø—Ä–µ–¥–µ–ª –∞–º–ø–ª–∏—Ç—É–¥—ã —Ä–∞–≤–µ–Ω 35% —Å—Ä–µ–¥–Ω–µ–≥–æ. –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç –æ–±–æ—Ä–æ—Ç–∞ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ 0,5% —Å—Ä–µ–¥–Ω–µ–≥–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –æ–±–æ—Ä–æ—Ç–∞ –≤ –≥–æ–¥, –Ω–æ –Ω–µ –Ω–∏–∂–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–æ–≥–æ –º–∏–Ω–∏–º—É–º–∞, —á—Ç–æ —Å—Ç–∞–±–∏–ª–∏–∑–∏—Ä—É–µ—Ç —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ –º–∞–ª—ã—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤. –ö–æ—Ä–∏–¥–æ—Ä —Å–∞–ª—å–¥–æ –∑–∞–¥–∞—ë—Ç—Å—è –ø–æ –ø—Ä–∞–≤–∏–ª—É <span class="math">[LB,UB]=[1,5¬∑min N^{hist},\,1,5¬∑max N^{hist}]</span> –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ–π –±—É–¥—É—â–µ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ <span class="math">N<sup>raw</sup><sub>t</sub></span>. –î–ª—è –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π ¬´—Ä–∏—Ñ–ª—ë–Ω–æ—Å—Ç–∏¬ª –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —Å–∏–Ω—É—Å–æ–∏–¥–∞–ª—å–Ω—ã–π —Å–∏–≥–Ω–∞–ª –º–∞–ª–æ–π –∞–º–ø–ª–∏—Ç—É–¥—ã —Å —Ñ–∞–∑–æ–π, –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π ¬´—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è√ó–ø–æ–ª¬ª, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å—Ç—Ä–æ–≥—É—é –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å.
–í—Å–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –ø–æ –ø–æ–ª—É; –∞–≥—Ä–µ–≥–∞—Ç ¬´–≤—Å–µ–≥–æ¬ª —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –ø–æ–ª–æ–≤ –ø–æ –≥–æ–¥–∞–º. –ù–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–º —Å–µ–≥–º–µ–Ω—Ç–µ 2017‚Äì2023 –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏—Ç–æ–∫–∞ –∏ –æ—Ç—Ç–æ–∫–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –Ω–∞–±–ª—é–¥–∞–µ–º—ã–º–∏, —Å—Ç–∞—Ç—É—Å—ã —Ç–æ—á–µ–∫ –ø–æ–º–µ—á–∞—é—Ç—Å—è –∫–∞–∫ ¬´–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ¬ª, –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≥–æ–¥—ã ‚Äî ¬´–ø—Ä–æ–≥–Ω–æ–∑¬ª. –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–ª—É—á–∞–π–Ω—ã—Ö —á–∏—Å–µ–ª —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç—Å—è –∑–∞—Ä–∞–Ω–µ–µ, –æ–¥–Ω–∞–∫–æ –≤ —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ –º–æ–¥–µ–ª—å –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä—É–µ—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏, –∞ –Ω–µ –∞–Ω—Å–∞–º–±–ª–∏, —á—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç —Å—Ç–æ—Ö–∞—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–∞–∑–±—Ä–æ—Å –º–µ–∂–¥—É –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–º–∏.
4. –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ö–µ–º–∞
–ê–ª–≥–æ—Ä–∏—Ç–º –≤–∫–ª—é—á–∞–µ—Ç —É—Å—Ç–æ–π—á–∏–≤—ã–π –ø–∞—Ä—Å–µ—Ä –∏—Å—Ö–æ–¥–Ω—ã—Ö –∫–Ω–∏–≥ –†–æ—Å—Å—Ç–∞—Ç–∞, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—é –Ω–∞–∏–º–µ–Ω–æ–≤–∞–Ω–∏–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –ø–æ –ø–∞—Ä–∞–º ¬´—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è √ó –ø–æ–ª¬ª, –æ—Ü–µ–Ω–∫—É —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö —Ä–µ–≥—Ä–µ—Å—Å–∏–π –¥–ª—è –ø—Ä–∏—Ç–æ–∫–∞ –∏ –æ—Ç—Ç–æ–∫–∞ –Ω–∞ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–º –æ–∫–Ω–µ, —Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ ¬´—Å—ã—Ä–æ–≥–æ¬ª –ø—Ä–æ–≥–Ω–æ–∑–∞ –Ω–∞ –≤–µ—Å—å –≥–æ—Ä–∏–∑–æ–Ω—Ç, —Ä–µ—Å–∫–µ–π–ª–∏–Ω–≥ –ø—Ä–æ–≥–Ω–æ–∑–Ω–æ–≥–æ —Å–∞–ª—å–¥–æ –≤–Ω—É—Ç—Ä–∏ –¥–æ–ø—É—Å—Ç–∏–º–æ–≥–æ –∫–æ—Ä–∏–¥–æ—Ä–∞ –∏ –ø–æ—à–∞–≥–æ–≤—É—é —Å–±–æ—Ä–∫—É –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —á–µ—Ä–µ–∑ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π –æ–±–æ—Ä–æ—Ç. –î–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏ —Ü–µ–ª–æ–µ –æ–∫—Ä—É–≥–ª–µ–Ω–∏–µ. –ì—Ä–∞–Ω–∏—Ü—ã –∫–æ–Ω—É—Å–∞ –∏ –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–æ—Å—Ç –æ–±–æ—Ä–æ—Ç–∞ –≤—ã—á–∏—Å–ª—è—é—Ç—Å—è –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã ¬´—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è √ó –ø–æ–ª¬ª –∏–∑ –µ—ë —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö, —á—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∞–ª—å–Ω–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—É—é –∫–∞–ª–∏–±—Ä–æ–≤–∫—É.
5. –í—ã—Ö–æ–¥–Ω—ã–µ –Ω–∞–±–æ—Ä—ã –¥–∞–Ω–Ω—ã—Ö
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤—ã–¥–∞—é—Ç—Å—è –≤ ¬´–¥–ª–∏–Ω–Ω–æ–º¬ª –∏ ¬´—à–∏—Ä–æ–∫–æ–º¬ª —Ñ–æ—Ä–º–∞—Ç–∞—Ö —Å —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∏ –ø–æ–ª–µ–º —Å—Ç–∞—Ç—É—Å–∞. –û—Å–Ω–æ–≤–Ω–æ–π ¬´–¥–ª–∏–Ω–Ω—ã–π¬ª –Ω–∞–±–æ—Ä —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–æ–Ω–∫–∏ ¬´–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è¬ª, ¬´–ü–æ–ª¬ª, ¬´–ì–æ–¥¬ª, ¬´–ü—Ä–∏–±—ã–ª¬ª, ¬´–í—ã–±—ã–ª¬ª, ¬´–°–∞–ª—å–¥–æ¬ª, ¬´–°—Ç–∞—Ç—É—Å¬ª. –û—Å–Ω–æ–≤–Ω–æ–π ¬´—à–∏—Ä–æ–∫–∏–π¬ª —Ñ–∞–π–ª ‚Äî –µ–¥–∏–Ω–∞—è –∫–Ω–∏–≥–∞ Excel —Å —Ç—Ä–µ–º—è –ª–∏—Å—Ç–∞–º–∏: inflow (–ø—Ä–∏—Ç–æ–∫), outflow (–æ—Ç—Ç–æ–∫) –∏ saldo (—Å–∞–ª—å–¥–æ); —Å—Ç—Ä–æ–∫–∏ ‚Äî –≥–æ–¥—ã –æ—Ç 2017 –¥–æ 2100, –∫–æ–ª–æ–Ω–∫–∏ ‚Äî –ø–∞—Ä–Ω–∞—è –º–Ω–æ–≥–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ [–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è, –ü–æ–ª], –≤–∫–ª—é—á–∞—è –∏ –∞–≥—Ä–µ–≥–∞—Ç ¬´–í—Å–µ–≥–æ¬ª. –í—Å–µ –≤—ã–ø—É—Å–∫–Ω—ã–µ —Ä—è–¥—ã –Ω–µ–ø—Ä–µ—Ä—ã–≤–Ω—ã –ø–æ –≥–æ–¥–∞–º –∏ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø—Ä–æ–ø—É—Å–∫–æ–≤.
–ò–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤, —Ñ–æ—Ä–º–∏—Ä—É–µ–º—ã—Ö –∫–æ–¥–æ–º: ¬´MIG_cyclic_tidy.csv¬ª –∏ ¬´MIG_cyclic_tidy.xlsx¬ª –¥–ª—è –¥–ª–∏–Ω–Ω–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –∏ ¬´MIG_cyclic_wide.xlsx¬ª –¥–ª—è —à–∏—Ä–æ–∫–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ —Å —Ç—Ä–µ–º—è –ª–∏—Å—Ç–∞–º–∏. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∞ —Å —Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–º–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏ —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏, –æ–∂–∏–¥–∞–µ–º–æ–π –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∂–∏–∑–Ω–∏ –∏ —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –Ω–∞—Å–µ–ª–µ–Ω–∏—è, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Ö –≤ –µ–¥–∏–Ω–æ–º —Å—Ü–µ–Ω–∞—Ä–Ω–æ–º –∫–æ–Ω–≤–µ–π–µ—Ä–µ.
6. –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç—å –∏ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
–î–ª—è –≤–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º–æ—Å—Ç–∏ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è: –Ω–∞–±–æ—Ä –∫–∞–Ω–¥–∏–¥–∞—Ç–Ω—ã—Ö –ø–µ—Ä–∏–æ–¥–æ–≤ <span class="math">P‚àà{3,4,5,6,7,8}</span>; –¥–æ–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –∞–º–ø–ª–∏—Ç—É–¥—ã –≥–∞—Ä–º–æ–Ω–∏–∫–∏ –ø–æ –æ—Ç–Ω–æ—à–µ–Ω–∏—é –∫ —Å—Ä–µ–¥–Ω–µ–º—É —É—Ä–æ–≤–Ω—é —Ä—è–¥–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 35%); –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≥–æ–¥–æ–≤–æ–π —Ä–æ—Å—Ç –æ–±–æ—Ä–æ—Ç–∞ –≤ –¥–æ–ª—è—Ö —Å—Ä–µ–¥–Ω–µ–≥–æ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –æ–±–æ—Ä–æ—Ç–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0,5%); –º–Ω–æ–∂–∏—Ç–µ–ª—å —à–∏—Ä–∏–Ω—ã –∫–æ–Ω—É—Å–∞ –¥–ª—è —Å–∞–ª—å–¥–æ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é ¬±50% –æ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞); –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Ñ–∞–∑–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π –≥–∞—Ä–º–æ–Ω–∏–∫–∏ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –≤—ã—Ä–æ–∂–¥–µ–Ω–∏—è —Å–∞–ª—å–¥–æ –≤ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—É. –í—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–¥–∞–Ω—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ, –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—â–µ–º –±–∞–ª–∞–Ω—Å –º–µ–∂–¥—É —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ—Å—Ç—å—é –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å—é –Ω–∞ –∫–æ—Ä–æ—Ç–∫–∏—Ö –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏—Ö –æ–∫–Ω–∞—Ö; –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–Ω–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –ø–µ—Ä–µ–æ—Ü–µ–Ω–µ–Ω—ã –¥–ª—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤.
7. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –∏ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è
–ú–µ—Ç–æ–¥–∏–∫–∞ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–∞ –¥–ª—è –∫—Ä–∞—Ç–∫–æ–π –∏—Å—Ö–æ–¥–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ (—Å–µ–º—å –≥–æ–¥–æ–≤—ã—Ö –Ω–∞–±–ª—é–¥–µ–Ω–∏–π), –≤ –∫–æ—Ç–æ—Ä–æ–π –æ—Ü–µ–Ω–∫–∞ ¬´—Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–æ–π¬ª –ø–µ—Ä–∏–æ–¥–∏—á–Ω–æ—Å—Ç–∏ –Ω–µ–∏–∑–±–µ–∂–Ω–æ –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å; –ø–æ—ç—Ç–æ–º—É –≥–∞—Ä–º–æ–Ω–∏–∫–∞ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞ –ø–æ –∞–º–ø–ª–∏—Ç—É–¥–µ, –∞ –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–π —Ä–æ—Å—Ç –æ–±–æ—Ä–æ—Ç–∞ ‚Äî –º–∏–Ω–∏–º–∞–ª–µ–Ω –∏ —Å–ª—É–∂–∏—Ç –ª–∏—à—å —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–æ–º –¥–∏–Ω–∞–º–∏–∫–∏, –∞ –Ω–µ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–µ–Ω–¥–∞. –ö–æ–Ω—É—Å —Å–∞–ª—å–¥–æ –∑–∞—â–∏—â–∞–µ—Ç –æ—Ç –Ω–µ—Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –ø—Ä–∏ –¥–ª–∏–Ω–Ω–æ–π —ç–∫—Å—Ç—Ä–∞–ø–æ–ª—è—Ü–∏–∏ –∏ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤–æ–ª–Ω–æ–æ–±—Ä–∞–∑–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É. –í –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å–ª–µ–¥—É–µ—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å, —á—Ç–æ –≤–Ω–µ—à–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ —à–æ–∫–∏, –∏–Ω—Å—Ç–∏—Ç—É—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∞–ª—å–Ω–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã, –Ω–µ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω–æ–º –æ–∫–Ω–µ 2017‚Äì2023 –≥–≥., –≤ –º–æ–¥–µ–ª—å –Ω–µ –∑–∞—à–∏—Ç—ã –∏ –¥–æ–ª–∂–Ω—ã —Ä–∞—Å—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å—Å—è –æ—Ç–¥–µ–ª—å–Ω–æ –≤ —Å—Ü–µ–Ω–∞—Ä–Ω–æ–π —Ä–∞–±–æ—Ç–µ.</pre>
      </details>
      <details>
        <summary>–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è</summary>
        <pre class="method-text">–ú–µ—Ç–æ–¥–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–≥–Ω–æ–∑–∞ —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –∏ —Å–æ—Å—Ç–∞–≤–∞ –Ω–∞—Å–µ–ª–µ–Ω–∏—è —Å—É–±—ä–µ–∫—Ç–æ–≤ –†–§ 
–Ω–∞ –ø–µ—Ä–∏–æ–¥ –¥–æ 2100 –≥–æ–¥–∞
1. –ò—Å—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∏—Ö —Ä–æ–ª—å –≤ –º–æ–¥–µ–ª–∏
–í —Ä–∞—Å—á—ë—Ç–∞—Ö –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ø—è—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤, –≤—Å–µ –ø–æ —Å—É–±—ä–µ–∫—Ç–∞–º –†–§: –≥–æ–¥–æ–≤—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã –æ–∂–∏–¥–∞–µ–º–æ–π –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∂–∏–∑–Ω–∏ –ø—Ä–∏ —Ä–æ–∂–¥–µ–Ω–∏–∏ (–ø–æ –ø–æ–ª—É) –∫–∞–∫ –¥—Ä–∞–π–≤–µ—Ä —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç–∏; –≥–æ–¥–æ–≤—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã —Å—É–º–º–∞—Ä–Ω–æ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏ –∫–∞–∫ –¥—Ä–∞–π–≤–µ—Ä —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏; –≥–æ–¥–æ–≤–æ–µ –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–∞–ª—å–¥–æ –ø–æ –ø–æ–ª—É; –±–∞–∑–æ–≤—ã–µ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ-–ø–æ–ª–æ–≤—ã–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ —Å—É–±—ä–µ–∫—Ç–∞–º, —è–≤–ª—è—é—â–∏–µ—Å—è —Å—Ç–∞—Ä—Ç–æ–≤—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º; —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø–æ–ª–æ–≤ –ø—Ä–∏ —Ä–æ–∂–¥–µ–Ω–∏–∏, —Ä–∞–≤–Ω–æ–µ 105,6 –º–∞–ª—å—á–∏–∫–∞ –Ω–∞ 100 –¥–µ–≤–æ—á–µ–∫. –û–ü–ñ e0 –∏ –°–ö–† –ø–æ–¥–∞—é—Ç—Å—è –≤ ¬´tidy¬ª-–≤–∏–¥–µ —Å —è–≤–Ω—ã–º–∏ –ø–æ–ª—è–º–∏ ¬´–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è¬ª, ¬´–ì–æ–¥¬ª, ¬´–ü–æ–ª¬ª/¬´TFR¬ª; –º–∏–≥—Ä–∞—Ü–∏—è ‚Äî —Å –ø–æ–ª—è–º–∏ ¬´–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è¬ª, ¬´–ü–æ–ª¬ª, ¬´–ì–æ–¥¬ª, ¬´–°–∞–ª—å–¥–æ¬ª. –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –±–∞–∑—ã –Ω–∞—Å–µ–ª–µ–Ω–∏—è –ø–æ–¥–∞—é—Ç—Å—è –≤ –∫–Ω–∏–≥–∞—Ö Excel, –≥–¥–µ –ø–µ—Ä–≤—ã–π —Å—Ç–æ–ª–±–µ—Ü ‚Äî –≤–æ–∑—Ä–∞—Å—Ç (–≤–∫–ª—é—á–∞—è –∫–∞—Ç–µ–≥–æ—Ä–∏—é ¬´100 –∏ –±–æ–ª–µ–µ¬ª), –≤—Ç–æ—Ä–æ–π ‚Äî —Å—É–±—ä–µ–∫—Ç, –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ —Å—Ç–æ–ª–±—Ü—ã ‚Äî –≥–æ–¥—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏–π (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´2022¬ª, ¬´2023¬ª, ¬´2024¬ª, ¬´2025¬ª).
2. –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏ –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è
–î–ª—è –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –∫–Ω–∏–≥ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç—Ä–æ–≥–∏–π –ø–∞—Ä—Å–µ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ ¬´–í–æ–∑—Ä–∞—Å—Ç | –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è | –ì–æ–¥—ã‚Ä¶¬ª. –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –º–µ—Ç–∫–∏ –Ω–æ—Ä–º–∞–ª–∏–∑—É—é—Ç—Å—è —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º–∏ –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º–∏ –≤ —Ü–µ–ª—ã–µ –≤–æ–∑—Ä–∞—Å—Ç–∞ 0‚Äì99 –∏ ¬´100+¬ª‚Üí100. –ò–∑ –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ —Å—Ç–æ–ª–±—Ü–æ–≤ –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è —á–µ—Ç—ã—Ä—ë—Ö–∑–Ω–∞—á–Ω—ã–µ –≥–æ–¥—ã; –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏—Å—Ç–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –¥–ª–∏–Ω–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ ¬´–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è‚Äì–ü–æ–ª‚Äì–ì–æ–¥‚Äì–í–æ–∑—Ä–∞—Å—Ç‚Äì–ß–∏—Å–ª–æ¬ª. –î—É–±–ª–∏–∫–∞—Ç—ã –ø–æ –∫–ª—é—á—É –∞–≥—Ä–µ–≥–∏—Ä—É—é—Ç—Å—è —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º, –∏—Å–∫–ª—é—á–∞—é—Ç—Å—è –ø—É—Å—Ç—ã–µ –∏ —è–≤–Ω–æ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ —Å—Ç—Ä–æ–∫–∏. –î–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã ¬´—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è‚Äì–ø–æ–ª¬ª –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –Ω–∞–±–ª—é–¥–∞–µ–º—ã–π –≥–æ–¥ –±–∞–∑–æ–≤–æ–≥–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è; —ç—Ç–æ –≥–æ–¥ —Å—Ç–∞—Ä—Ç–∞ –ø–µ—Ä–µ–¥–≤–∏–∂–∫–∏.
–î–ª—è –û–ü–ñ –∏ –°–ö–† –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫ —Å ¬´—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–µ–π¬ª –∏ ¬´–≥–æ–¥–æ–º¬ª; –¥–ª—è –°–ö–† –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è ¬´–≥–ª–∞–≤–Ω–∞—è¬ª —á–∏—Å–ª–æ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ TFR –ø–æ –ø—Ä–∞–≤–¥–æ–ø–æ–¥–æ–±–Ω–æ–º—É –¥–∏–∞–ø–∞–∑–æ–Ω—É, –¥–æ–ª–µ —á–∏—Å–ª–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –∏ –∫–ª—é—á–µ–≤—ã–º —Å–ª–æ–≤–∞–º –≤ –∏–º–µ–Ω–∏. –ú–∏–≥—Ä–∞—Ü–∏—è –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∫ –¥–≤—É–º –ø–æ–ª—É-—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–º –≤—Ä–µ–º–µ–Ω–Ω—ã–º —Ä—è–¥–∞–º —Å–∞–ª—å–¥–æ.
–ï—Å–ª–∏ –¥–ª—è —á–∞—Å—Ç–∏ –ª–µ—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∑–Ω–∞—á–µ–Ω–∏—è e0 –∏–ª–∏ TFR, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–ª–∏–∂–∞–π—à–µ–µ –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–∞–Ω–Ω–æ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –∏ –ø–æ–ª–∞; –ø—Ä–∏ –ø–æ–ª–Ω–æ–º –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ñ–æ–ª–ª–±—ç–∫ –ø–æ –ø–æ–ª—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, <span class="math">e0=70</span> –¥–ª—è –º—É–∂—á–∏–Ω/<span class="math">78</span> –¥–ª—è –∂–µ–Ω—â–∏–Ω; <span class="math">TFR=1,5</span>). –≠—Ç–∏ —Ñ–æ–ª–ª–±—ç–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ç–∞–º, –≥–¥–µ –∏—Å—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –∑–Ω–∞—á–µ–Ω–∏–π, –∏ —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–º –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–∏ –Ω–æ—É—Ç–±—É–∫–∞.
3. –ú–æ–¥—É–ª—å —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç–∏: —Ç–∞–±–ª–∏—Ü—ã –∂–∏–∑–Ω–∏ –∏–∑ e0
–î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª–∞ –∑–∞–¥–∞–Ω –≥–ª–∞–¥–∫–∏–π ¬´—à–∞–±–ª–æ–Ω¬ª –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç–µ–π <span class="math">m<sup>templ</sup><sub>x</sub></span>(–ø—Ä–∏–±–ª–∏–∂—ë–Ω–Ω–∞—è Gompertz‚ÄìMakeham-–ø–æ–¥–æ–±–Ω–∞—è –∫—Ä–∏–≤–∞—è —Å —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–π –º–ª–∞–¥–µ–Ω—á–µ—Å–∫–æ–π –∏ –¥–µ—Ç—Å–∫–æ–π —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å—é), –∏–∑ –∫–æ—Ç–æ—Ä–æ–≥–æ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –≥–æ–¥–∞ –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ —Å—Ç—Ä–æ–∏—Ç—Å—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∂–∏–∑–Ω–∏, —Å—Ç—Ä–æ–≥–æ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–∞—è —Å –∑–∞–¥–∞–Ω–Ω—ã–º e0. –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ–º <span class="math">m<sub>x</sub>=s¬∑m<sup>templ</sup><sub>x</sub></span> –º–µ—Ç–æ–¥–æ–º –¥–≤–æ–∏—á–Ω–æ–≥–æ –ø–æ–∏—Å–∫–∞ –ø–æ –º–Ω–æ–∂–∏—Ç–µ–ª—é <span class="math">s</span> –¥–æ —Ç–µ—Ö –ø–æ—Ä, –ø–æ–∫–∞ –æ–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∂–∏–∑–Ω–∏ <span class="math">e<sub>0</sub></span> —Ç–∞–±–ª–∏—á–∫–∏ –Ω–µ —Å–æ–≤–ø–∞–¥—ë—Ç —Å —Ü–µ–ª–µ–≤–æ–π –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –¥–æ–ø—É—Å–∫–∞. –ù–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö m<sub>x</sub> —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞—é—Ç—Å—è —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –ø–æ–∫–∞–∑–∞—Ç–µ–ª–∏ q_x,l_x,L_x,T_x–∏ –º–µ–∂–≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ –¥–æ–∂–∏—Ç–∏—è <span class="math">S<sub>x</sub>=l<sub>x+1</sub>/l<sub>x</sub></span>(–¥–ª—è –æ—Ç–∫—Ä—ã—Ç–æ–π –≥—Ä—É–ø–ø—ã ¬´100+¬ª ‚Äî —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–µ –ø—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ <span class="math">S<sub>100</sub>=e^{‚àím<sub>100</sub>}</span>). –≠—Ç–∏ S_x–¥–∞–ª–µ–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –∫–∞–∫ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –≤—ã–∂–∏–≤–∞–Ω–∏—è –≤ –ø–µ—Ä–µ—Ö–æ–¥–µ –∏–∑ –≥–æ–¥–∞ t–≤ –≥–æ–¥ t+1.
4. –ú–æ–¥—É–ª—å —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏: –¥–∏—Å–∞–≥—Ä–µ–≥–∞—Ü–∏—è TFR –≤ ASFR
–ì–æ–¥–æ–≤–æ–π TFR –ø–æ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ —Ä–∞–∑–≤–∏–≤–∞–µ—Ç—Å—è –ø–æ –ø—Ä–æ–≥–Ω–æ–∑—É. –î–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –µ–≥–æ –ø–æ –æ–¥–Ω–æ-–ª–µ—Ç–Ω—ã–º –≤–æ–∑—Ä–∞—Å—Ç–∞–º 15‚Äì49 –ª–µ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≥–ª–∞–¥–∫–∏–π –≤–µ—Å–æ–≤–æ–π –ø—Ä–æ—Ñ–∏–ª—å –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏ <span class="math">w<sub>a</sub></span> (–Ω–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫ —Å—É–º–º–µ —Ä–∞–≤–Ω–æ–π 1; —Ü–µ–Ω—Ç—Ä –º–∞—Å—Å—ã –æ–∫–æ–ª–æ 27‚Äì29 –ª–µ—Ç –∏ —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω–æ–µ –∑–∞—Ç—É—Ö–∞–Ω–∏–µ –∫ –∫—Ä–∞—è–º). –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã –∑–∞–¥–∞—é—Ç—Å—è –∫–∞–∫ <span class="math">ASFR<sub>a</sub>=TFR¬∑w<sub>a</sub></span>. –ß–∏—Å–ª–æ —Ä–æ–∂–¥–µ–Ω–∏–π –≤ –≥–æ–¥—É t–≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –∫–∞–∫ —Å–∫–∞–ª—è—Ä–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∂–µ–Ω—Å–∫–æ–π —ç–∫—Å–ø–æ–∑–∏—Ü–∏–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–º –Ω–∞ –Ω–∞—á–∞–ª–æ –≥–æ–¥–∞ –∏ –≤–µ–∫—Ç–æ—Ä–∞ ASFR. –ü–æ–ª–æ–≤–æ–µ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –ø—Ä–∏ —Ä–æ–∂–¥–µ–Ω–∏–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ: –¥–æ–ª—è –º–∞–ª—å—á–∏–∫–æ–≤ <span class="math">p<sub>m</sub>=105,6/(105,6+100)</span>, –¥–µ–≤–æ—á–µ–∫ <span class="math">p<sub>f</sub>=1‚àíp<sub>m</sub></span>. –í—ã–∂–∏–≤–∞–Ω–∏–µ –Ω–æ–≤–æ—Ä–æ–∂–¥—ë–Ω–Ω—ã—Ö –≤ –ø–µ—Ä–≤—ã–π –≥–æ–¥ –∂–∏–∑–Ω–∏ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ <span class="math">S<sub>0</sub></span> –ø–æ–ª–∞, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–Ω—ã–π –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –∂–∏–∑–Ω–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –≥–æ–¥–∞ –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏.
5. –ú–æ–¥—É–ª—å –º–∏–≥—Ä–∞—Ü–∏–∏: —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –≥–æ–¥–æ–≤–æ–≥–æ —Å–∞–ª—å–¥–æ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–º
–í —Å—Ü–µ–Ω–∞—Ä–∏–∏ ¬´—Å –º–∏–≥—Ä–∞—Ü–∏–µ–π¬ª –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≥–æ–¥–æ–≤–æ–µ –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–∞–ª—å–¥–æ –ø–æ –ø–æ–ª—É –∏–∑ –≤—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞. –≠—Ç–æ —Å–∞–ª—å–¥–æ —Ä–∞–∑–±—Ä–∞—Å—ã–≤–∞–µ—Ç—Å—è –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–º —Å –ø–æ–º–æ—â—å—é –≥–ª–∞–¥–∫–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è Rogers‚ÄìCastro (–º–æ–¥–∞–ª—å–Ω–∞—è –º–æ–ª–æ–¥–∞—è –≤–æ–ª–Ω–∞ —Å –Ω–µ–±–æ–ª—å—à–∏–º–∏ –¥–æ–ª—è–º–∏ –≤ –¥–µ—Ç—Å–∫–æ-–ø–æ–¥—Ä–æ—Å—Ç–∫–æ–≤—ã—Ö –∏ —Å—Ç–∞—Ä—à–∏—Ö –≤–æ–∑—Ä–∞—Å—Ç–∞—Ö). –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ–µ —Å–∞–ª—å–¥–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–∞—ë—Ç –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–∏–±–∞–≤–∫–∏; –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–µ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ-–ø–æ–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç—Å–µ–∫–∞—Ç–µ–ª—å–Ω–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è –Ω—É–ª—ë–º —Å–Ω–∏–∑—É. –í —Å—Ü–µ–Ω–∞—Ä–∏–∏ ¬´–±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏¬ª –≤–µ—Å—å –±–ª–æ–∫ —Å–∞–ª—å–¥–æ –æ–±–Ω—É–ª—è–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π –∏ –ª–µ—Ç, —á—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—É—á–∏—Ç—å —á–∏—Å—Ç–æ –µ—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π.
6. –ü–µ—Ä–µ–¥–≤–∏–∂–∫–∞ –≤–æ–∑—Ä–∞—Å—Ç–æ–≤ (–∫–æ–≥–æ—Ä—Ç–Ω–æ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è –ø—Ä–æ–µ–∫—Ü–∏—è)
–ü—Ä–æ–µ–∫—Ü–∏—è –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ –æ—Ç –±–∞–∑–æ–≤–æ–≥–æ –≥–æ–¥–∞ t_0–¥–æ 2100 –≥–æ–¥–∞. –ù–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ –¥–ª—è –º—É–∂—á–∏–Ω –∏ –∂–µ–Ω—â–∏–Ω –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –æ–ø–µ—Ä–∞—Ü–∏–∏ –≤ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ: –≤—ã–∂–∏–≤–∞–Ω–∏–µ –∏ —Å—Ç–∞—Ä–µ–Ω–∏–µ –∫–æ–≥–æ—Ä—Ç –ø–æ <span class="math">S<sub>x</sub></span>; —Ä–æ–∂–¥–µ–Ω–∏–µ –º–∞–ª—å—á–∏–∫–æ–≤ –∏ –¥–µ–≤–æ—á–µ–∫ –ø–æ <span class="math">ASFR<sub>a</sub></span> –∏ <span class="math">S<sub>0</sub></span>; –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –ø—Ä–æ—Ñ–∏–ª—è–º; —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–±—Ä–µ–∑–∞–Ω–∏–µ –æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –¥–æ –Ω—É–ª—è. –î–ª—è –æ—Ç–∫—Ä—ã—Ç–æ–π –≥—Ä—É–ø–ø—ã ¬´100+¬ª —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å –∏ –º–∏–≥—Ä–∞—Ü–∏—è –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è –∞–¥–¥–∏—Ç–∏–≤–Ω–æ, –∞ –≤—ã–∂–∏–≤–∞–Ω–∏–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ —É–º–Ω–æ–∂–µ–Ω–∏–µ–º –Ω–∞ <span class="math">S<sub>100</sub></span>. –ù–∞–±–ª—é–¥–∞–µ–º—ã–µ –±–∞–∑–æ–≤—ã–µ –≥–æ–¥—ã, –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –≤ –∏—Å—Ö–æ–¥–Ω—ã—Ö –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –∫–Ω–∏–≥–∞—Ö, –≤–∫–ª—é—á–∞—é—Ç—Å—è –≤ –∏—Ç–æ–≥ –±–µ–∑ –∫–∞–∫–∏—Ö-–ª–∏–±–æ –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–π; –ø–æ—Å–ª–µ –±–∞–∑–æ–≤–æ–≥–æ –≥–æ–¥–∞ –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —è–≤–ª—è—é—Ç—Å—è –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã–º–∏ –∏ –ø–æ–º–µ—á–∞—é—Ç—Å—è —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º —Å—Ç–∞—Ç—É—Å–æ–º. –ò—Ç–æ–≥ –ø–æ –ø–æ–ª—É ¬´–í—Å–µ–≥–æ¬ª —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è —Å—É–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ–º –º—É–∂—Å–∫–æ–≥–æ –∏ –∂–µ–Ω—Å–∫–æ–≥–æ –º–∞—Å—Å–∏–≤–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —à–∞–≥–µ.
7. –ö–æ–Ω—Ç—Ä–æ–ª—å –∫–∞—á–µ—Å—Ç–≤–∞ –∏ —É—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç–∏
–î–æ —Å—Ç–∞—Ä—Ç–∞ —Ä–∞—Å—á—ë—Ç–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –ø–æ–ª–Ω–æ—Ç–∞ –±–∞–∑–æ–≤—ã—Ö –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –º–∞—Ç—Ä–∏—Ü –¥–ª—è –∫–∞–∂–¥–æ–π –ø–∞—Ä—ã ¬´—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è‚Äì–ø–æ–ª‚Äì–≥–æ–¥¬ª: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –≤–æ–∑—Ä–∞—Å—Ç–æ–≤ –∏ —Å—É–º–º–∞—Ä–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–º–∏; –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ. –í–Ω—É—Ç—Ä–∏ —à–∞–≥–∞ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≥–∞—Ä–∞–Ω—Ç–∏–∏ –Ω–µ–æ—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –¥–ª—è –≤—Å–µ—Ö —è—á–µ–µ–∫, —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –º–ª–∞–¥–µ–Ω—á–µ—Å–∫–æ–π –≤—ã–∂–∏–≤–∞–µ–º–æ—Å—Ç–∏ —Å —Ç–∞–±–ª–∏—Ü–µ–π –∂–∏–∑–Ω–∏, –∞ —Ç–∞–∫–∂–µ –¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞: —Ä–∞—Å—á—ë—Ç –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ª—É—á–∞–π–Ω–æ—Å—Ç–∏, –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ø—Ä–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –≤—Ö–æ–¥–∞—Ö –ø–æ–≤—Ç–æ—Ä—è–µ–º—ã. –î–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏—è Excel-–ª–∏—Å—Ç–æ–≤ –ø–æ–ª–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π ¬´tidy¬ª –º–∞—Å—Å–∏–≤ –ø–∏—à–µ—Ç—Å—è –≤ CSV; —à–∏—Ä–æ–∫–∏–µ –∏ —Å–≤–æ–¥–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã, –∏–º–µ—é—â–∏–µ —Ä–∞–∑—É–º–Ω—ã–π —Ä–∞–∑–º–µ—Ä, –≤—ã–≥—Ä—É–∂–∞—é—Ç—Å—è –≤ XLSX.
8. –í—ã—Ö–æ–¥–Ω—ã–µ —Ñ–∞–π–ª—ã –∏ –∏—Ö —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
–ê–ª–≥–æ—Ä–∏—Ç–º —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç –¥–≤–∞ –ø–æ–ª–Ω—ã—Ö –∫–æ–º–ø–ª–µ–∫—Ç–∞ —Ñ–∞–π–ª–æ–≤ ‚Äî –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è ¬´—Å –º–∏–≥—Ä–∞—Ü–∏–µ–π¬ª (—Å—É—Ñ—Ñ–∏–∫—Å withMIG) –∏ ¬´–±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏¬ª (—Å—É—Ñ—Ñ–∏–∫—Å noMIG). –ü–æ–ª–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –º–∞—Å—Å–∏–≤ –ø–æ –≤—Å–µ–º —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è–º, –ø–æ–ª–∞–º, –≥–æ–¥–∞–º –∏ –æ–¥–Ω–æ-–ª–µ—Ç–Ω—ã–º –≤–æ–∑—Ä–∞—Å—Ç–∞–º —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ñ–∞–π–ª–∞—Ö POP_forecast_age_tidy_withMIG.csv –∏ POP_forecast_age_tidy_noMIG.csv. –í –∫–∞–∂–¥–æ–º CSV —Å–æ–¥–µ—Ä–∂–∞—Ç—Å—è –ø–æ–ª—è ¬´–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è¬ª, ¬´–ü–æ–ª¬ª, ¬´–ì–æ–¥¬ª, ¬´–í–æ–∑—Ä–∞—Å—Ç¬ª, ¬´–í–æ–∑—Ä–∞—Å—Ç–°—Ç—Ä–æ–∫–∞¬ª (–≤–∫–ª—é—á–∞—è ¬´100+¬ª), ¬´–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å¬ª (—Ü–µ–ª–æ–µ), ¬´–°—Ç–∞—Ç—É—Å¬ª (¬´–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ¬ª –∏–ª–∏ ¬´–ø—Ä–æ–≥–Ω–æ–∑¬ª).
–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞—é—Ç—Å—è —à–∏—Ä–æ–∫–∏–µ XLSX-—Ç–∞–±–ª–∏—Ü—ã –ø–æ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—É –∏ –ø–æ –∏—Ç–æ–≥—É ¬´–í—Å–µ–≥–æ¬ª: POP_wide_male_{scenario}.xlsx, POP_wide_female_{scenario}.xlsx, POP_wide_total_{scenario}.xlsx. –í –∫–∞–∂–¥–æ–π –∫–Ω–∏–≥–µ —Ç—Ä–∏ –ª–∏—Å—Ç–∞: ¬´by_age¬ª ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ [\mathrm{–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è√ó–ì–æ–¥]–Ω–∞ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö 0, 1, ‚Ä¶, 99, ¬´100+¬ª; ¬´by_territory¬ª ‚Äî –º–∞—Ç—Ä–∏—Ü–∞ [\mathrm{–ì–æ–¥√ó–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è]–≥–æ–¥–æ–≤—ã—Ö –∏—Ç–æ–≥–æ–≤ –ø–æ –ø–æ–ª—É; ¬´status¬ª ‚Äî –∞–Ω–∞–ª–æ–≥–∏—á–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ ¬´–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ/–ø—Ä–æ–≥–Ω–æ–∑¬ª.
–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã —Ç–∞–∫–∂–µ –∫–æ–º–ø–∞–∫—Ç–Ω—ã–µ ¬´tidy¬ª-–∏—Ç–æ–≥–∏ –ø–æ –ø–æ–ª—É –∏ –∏—Ç–æ–≥—É ¬´–í—Å–µ–≥–æ¬ª: POP_total_tidy_withMIG.(csv|xlsx) –∏ POP_total_tidy_noMIG.(csv|xlsx). –í –Ω–∏—Ö –Ω–∞ –∫–∞–∂–¥—ã–π –≥–æ–¥ –∏ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—é –ø—Ä–∏–≤–æ–¥–∏—Ç—Å—è –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–æ –ø–æ–ª—É –∏ –æ–±—â–∏–π –∏—Ç–æ–≥; —Ñ–æ—Ä–º–∞—Ç –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ –¥–∏–Ω–∞–º–∏–∫–∏ –∏ –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ —É—Ä–æ–≤–Ω—è–º.
9. –ò–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏—è –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
–ü—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–Ω—Ç—É—Ä ‚Äî —Å—Ç—Ä–æ–≥–∞—è –∫–æ–≥–æ—Ä—Ç–Ω–æ-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–Ω–∞—è –ø–µ—Ä–µ–¥–≤–∏–∂–∫–∞, –≥–¥–µ —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å –ø—Ä–∏–≤—è–∑–∞–Ω–∞ –∫ –∑–∞–¥–∞–Ω–Ω–æ–π —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ e0 —á–µ—Ä–µ–∑ —Ç–∞–±–ª–∏—Ü—É –∂–∏–∑–Ω–∏, —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç—å ‚Äî –∫ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ TFR —á–µ—Ä–µ–∑ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª—å, –º–∏–≥—Ä–∞—Ü–∏—è ‚Äî –∫ –≥–æ–¥–æ–≤–æ–º—É —Å–∞–ª—å–¥–æ —á–µ—Ä–µ–∑ –≥–ª–∞–¥–∫–∏–π –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª—å. –≠—Ç–æ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å –≤—Ö–æ–¥–Ω—ã–º–∏ –ø—Ä–æ–≥–Ω–æ–∑–∞–º–∏ e0 –∏ TFR, —Ñ–∏–∑–∏—á–µ—Å–∫—É—é —Ä–µ–∞–ª–∏–∑—É–µ–º–æ—Å—Ç—å –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö —ç–≤–æ–ª—é—Ü–∏–π –∏ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å –≤–∫–ª–∞–¥–∞ –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Å–≤—è–∑–∞–Ω—ã —Å —ç–∫–∑–æ–≥–µ–Ω–Ω–æ –∑–∞–¥–∞–Ω–Ω–æ–π —Ñ–æ—Ä–º–æ–π –ø—Ä–æ—Ñ–∏–ª–µ–π: –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –ø—Ä–æ—Ñ–∏–ª—å —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏ –Ω–µ –≤–∞—Ä—å–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º–µ–Ω–∏ –∏ –ø–æ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è–º; –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å –æ–¥–∏–Ω–∞–∫–æ–≤ –ø–æ –≥–æ–¥–∞–º –∏ –∑–∞–≤–∏—Å–∏—Ç —Ç–æ–ª—å–∫–æ –æ—Ç –ø–æ–ª–∞; —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç—å –∫–∞–ª–∏–±—Ä—É–µ—Ç—Å—è –ø–æ e0 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º —à–∞–±–ª–æ–Ω–Ω–æ–π —Ñ–æ—Ä–º—ã m_x, –∞ –Ω–µ –ø–æ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–º –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º —Ä—è–¥–∞–º q_x. –í–æ–ø—Ä–æ—Å—ã —Ç–µ–º–ø–∞ —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏, —Å–¥–≤–∏–≥–æ–≤ –∫–æ–≥–æ—Ä—Ç–æ-–≤–æ–∑—Ä–∞—Å—Ç–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Ñ–µ—Ä—Ç–∏–ª—å–Ω–æ—Å—Ç–∏, –∞ —Ç–∞–∫–∂–µ —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–π –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –ø–æ—Ç–æ–∫–∏ –ø—Ä–∏–±—ã—Ç–∏—è/–≤—ã–±—ã—Ç–∏—è –Ω–∞—Ö–æ–¥—è—Ç—Å—è –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ —Ç–µ–∫—É—â–µ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –º–æ–≥—É—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω—ã –∫–∞–∫ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö.
10. –í–æ–∑–º–æ–∂–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è
–ü–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–æ–∑–º–æ–∂–Ω–∞ –∑–∞–º–µ–Ω–∞ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π –Ω–∞ —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–∞–ª—å–Ω–æ- –∏ –≤—Ä–µ–º–µ–Ω–Ω√≥-—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–µ: –ø—Ä–æ–≥–Ω–æ–∑ ASFR –ø–æ –≤–æ–∑—Ä–∞—Å—Ç–∞–º –≤–º–µ—Å—Ç–æ TFR√óweights; –ø—Ä–æ–≥–Ω–æ–∑ –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ-—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–æ–π —Å–º–µ—Ä—Ç–Ω–æ—Å—Ç–∏ –ø–æ –ø–æ–ª—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á–µ—Ä–µ–∑ —É–ª—É—á—à–µ–Ω–∏—è m_x–∏–ª–∏ q_x); —Ä–∞–∑–ª–æ–∂–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –Ω–∞ –ø—Ä–∏—Ç–æ–∫ –∏ –æ—Ç—Ç–æ–∫ —Å –æ—Ç–¥–µ–ª—å–Ω—ã–º–∏ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º–∏ –ø—Ä–æ—Ñ–∏–ª—è–º–∏ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ–º —Å —Å–∞–ª—å–¥–æ; —É—á—ë—Ç –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö —à–æ–∫–æ–≤ —á–µ—Ä–µ–∑ —Å—Ü–µ–Ω–∞—Ä–Ω—ã–µ –º–Ω–æ–∂–∏—Ç–µ–ª–∏ –∫ S_x, ASFR –∏ –≤–æ–∑—Ä–∞—Å—Ç–Ω—ã–º –ø—Ä–æ—Ñ–∏–ª—è–º –º–∏–≥—Ä–∞—Ü–∏–∏. –≠—Ç–∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Å–æ–≤–º–µ—Å—Ç–∏–º—ã —Å —Ç–µ–∫—É—â–µ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –∫–æ–¥–∞ –∏ —Ñ–∞–π–ª–æ–≤ –∏ –º–æ–≥—É—Ç –±—ã—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ –≤—ã–¥–∞—á–∏.</pre>
      </details>
    </div>
  </div>

  <div id="logBox" class="card small"></div>
</main>
<footer>
  –°–∏—Ç–∫–æ–≤—Å–∫–∏–π –ê—Ä—Å–µ–Ω–∏–π –ú–∏—Ö–∞–π–ª–æ–≤–∏—á, 2025
</footer>

<script>
// ------------------- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ -------------------
const files = {
  le:  'LE_Russia_subjects_forecast_2100_long.csv',
  tfr: 'TFR_Russia_subjects_ML_GP_UCM_tidy.csv',
  mig: 'MIG_cyclic_tidy.csv',
  pop_xlsx: {
    withMIG: { male: 'POP_wide_male_withMIG.xlsx', female: 'POP_wide_female_withMIG.xlsx' },
    noMIG:   { male: 'POP_wide_male_noMIG.xlsx',  female: 'POP_wide_female_noMIG.xlsx'  }
  }
};

const state = {
  le: [], tfr: [], mig: [],
  pop_with: [], pop_nom: [],
  terrs: [],
  years: {min:2017, max:2100}
};

function exportToXLSX(filename, rows, sheetName='–î–∞–Ω–Ω—ã–µ'){
  if(!rows || !rows.length){
    alert('–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤—ã–≥—Ä—É–∑–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã.');
    return;
  }
  const ws = XLSX.utils.json_to_sheet(rows);
  const wb = {SheetNames:[sheetName], Sheets:{}};
  wb.Sheets[sheetName] = ws;
  XLSX.writeFile(wb, filename);
}

// ------------------- –£—Ç–∏–ª–∏—Ç—ã -------------------
function trim(x){ return (x==null? '' : String(x)).trim(); }
function cleanTerritory(x){
  // —É–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –Ω–æ–º–µ—Ä–∞/—Ç–æ—á–∫–∏ –ø–µ—Ä–µ–¥ –Ω–∞–∑–≤–∞–Ω–∏–µ–º
  return trim(x).replace(/^[0-9.,\-]+\)?\s*/,'');
}
function toInt(x){
  const v = parseInt(String(x).replace(/\s+/g,''),10);
  return Number.isFinite(v)? v : null;
}
function toNum(x){
  const v = Number(String(x).replace(/\s+/g,'').replace(',', '.'));
  return Number.isFinite(v)? v : null;
}
function normSex(s){
  s = trim(s).toLowerCase();
  if(!s) return '';
  if(s.startsWith('–º—É–∂')) return '–ú—É–∂—á–∏–Ω—ã';
  if(s.startsWith('–∂–µ–Ω')) return '–ñ–µ–Ω—â–∏–Ω—ã';
  if(s.includes('–≤—Å–µ–≥–æ') || s.includes('–∏—Ç–æ–≥') || s.includes('total')) return '–í—Å–µ–≥–æ';
  if(s.includes('male')) return '–ú—É–∂—á–∏–Ω—ã';
  if(s.includes('fem') || s.includes('women')) return '–ñ–µ–Ω—â–∏–Ω—ã';
  return s;
}

// –∫–ª—é—á–µ–≤–æ–π —Ñ–∏–∫—Å: –∫–∞—Ä—Ç–∞ –∞–ª–∏–∞—Å–æ–≤ -> –∏–º–µ–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫
function normMapFromHeaders(row){
  const m = {};
  Object.keys(row || {}).forEach(k=>{
    const kk = k.toLowerCase().trim();
    if(!m[kk]) m[kk] = k;
  });
  return m;
}

function guessCol(map, aliases){
  for(const a of aliases){
    const key = a.toLowerCase();
    if(map[key]) return map[key];
  }
  return null;
}

function parseCSV(url){
  return new Promise((resolve, reject)=>{
    Papa.parse(url, {
      header:true,
      download:true,
      dynamicTyping:false,
      skipEmptyLines:true,
      complete: r => resolve(r.data),
      error: err => reject(err)
    });
  });
}

async function fetchArrayBuffer(url){
  const res = await fetch(url);
  if(!res.ok) throw new Error(`HTTP ${res.status} –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ ${url}`);
  return await res.arrayBuffer();
}

// ------------------- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è LE -------------------
function normalizeLE(rows){
  if(!rows || !rows.length) return [];
  const headerMap = normMapFromHeaders(rows[0]);
  const colT = guessCol(headerMap, ['—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è','territory','—Ä–µ–≥–∏–æ–Ω','—Å—É–±—ä–µ–∫—Ç','region','subject']);
  const colY = guessCol(headerMap, ['–≥–æ–¥','year']);
  const colS = guessCol(headerMap, ['–ø–æ–ª','sex','gender']);
  const colLE1 = guessCol(headerMap, ['le','–æ–∂–∏–¥–∞–µ–º–∞—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∂–∏–∑–Ω–∏','–æ–ø–∂','life expectancy']);
  const colSt = guessCol(headerMap, ['—Å—Ç–∞—Ç—É—Å','status']);

  // –µ—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ —è–≤–Ω—É—é –∫–æ–ª–æ–Ω–∫—É —Å LE, –ø–æ–ø—Ä–æ–±—É–µ–º –≤–∑—è—Ç—å –ª—é–±–æ–π —á–∏—Å–ª–æ–≤–æ–π —Å—Ç–æ–ª–±–µ—Ü
  let colLE = colLE1;
  if(!colLE){
    const headers = Object.keys(rows[0]);
    outer: for(const h of headers){
      if(h===colT || h===colY || h===colS || h===colSt) continue;
      let cnt=0, good=0;
      for(let i=0;i<rows.length && i<100;i++){
        const v = toNum(rows[i][h]);
        if(v==null) continue;
        cnt++;
        if(v>20 && v<100) good++;
      }
      if(cnt>10 && good/cnt>0.8){ colLE=h; break outer; }
    }
  }
  if(!colT || !colY || !colS || !colLE){
    console.warn('LE: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–ª–æ–Ω–æ–∫', {colT,colY,colS,colLE});
    return [];
  }

  const out=[];
  for(const r of rows){
    const t = cleanTerritory(r[colT]); if(!t) continue;
    const y = toInt(r[colY]); if(!y) continue;
    const sx = normSex(r[colS]); if(sx!=='–ú—É–∂—á–∏–Ω—ã' && sx!=='–ñ–µ–Ω—â–∏–Ω—ã') continue;
    const v  = toNum(r[colLE]); if(v==null) continue;
    const st = colSt? trim(r[colSt]) : (y<=2023? '–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ':'–ø—Ä–æ–≥–Ω–æ–∑');
    out.push({–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è:t, –ü–æ–ª:sx, –ì–æ–¥:y, LE:v, –°—Ç–∞—Ç—É—Å:st});
  }
  out.sort((a,b)=> a.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è.localeCompare(b.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è) || a.–ü–æ–ª.localeCompare(b.–ü–æ–ª) || (a.–ì–æ–¥-b.–ì–æ–¥));
  return out;
}

// ------------------- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è TFR -------------------
function normalizeTFR(rows){
  if(!rows || !rows.length) return [];
  const headerMap = normMapFromHeaders(rows[0]);
  const colT = guessCol(headerMap, ['—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è','territory','—Ä–µ–≥–∏–æ–Ω','—Å—É–±—ä–µ–∫—Ç','region','subject']);
  const colY = guessCol(headerMap, ['–≥–æ–¥','year']);
  const colSt= guessCol(headerMap, ['—Å—Ç–∞—Ç—É—Å','status']);
  let   colV = guessCol(headerMap, ['tfr','—Å—É–º–º–∞—Ä–Ω—ã–π –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Ä–æ–∂–¥–∞–µ–º–æ—Å—Ç–∏','—Å–∫—Ä','value','mean','median']);

  if(!colV){
    const headers = Object.keys(rows[0]);
    outer: for(const h of headers){
      if(h===colT || h===colY || h===colSt) continue;
      let cnt=0, good=0;
      for(let i=0;i<rows.length && i<100;i++){
        const v = toNum(rows[i][h]);
        if(v==null) continue;
        cnt++;
        if(v>0.5 && v<5.0) good++;
      }
      if(cnt>10 && good/cnt>0.7){ colV=h; break outer; }
    }
  }

  if(!colT || !colY || !colV){
    console.warn('TFR: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫–æ–ª–æ–Ω–æ–∫', {colT,colY,colV});
    return [];
  }

  const out=[];
  for(const r of rows){
    const t = cleanTerritory(r[colT]); if(!t) continue;
    const y = toInt(r[colY]); if(!y) continue;
    const v = toNum(r[colV]); if(v==null) continue;
    const st = colSt? trim(r[colSt]) : (y<=2023? '–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ':'–ø—Ä–æ–≥–Ω–æ–∑');
    out.push({–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è:t, –ì–æ–¥:y, TFR:v, –°—Ç–∞—Ç—É—Å:st});
  }
  out.sort((a,b)=> a.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è.localeCompare(b.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è) || (a.–ì–æ–¥-b.–ì–æ–¥));
  return out;
}

// ------------------- –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏ -------------------
function normalizeMIG(rows){
  if(!rows || !rows.length) return [];
  const headerMap = normMapFromHeaders(rows[0]);
  const colT = guessCol(headerMap, ['—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è','territory','—Ä–µ–≥–∏–æ–Ω','—Å—É–±—ä–µ–∫—Ç','region','subject']);
  const colY = guessCol(headerMap, ['–≥–æ–¥','year']);
  const colS = guessCol(headerMap, ['–ø–æ–ª','sex','gender']);
  const colI = guessCol(headerMap, ['–ø—Ä–∏–±—ã–≤','inflow','–ø—Ä–∏–±—ã–ª']);
  const colO = guessCol(headerMap, ['–≤—ã–±—ã–ª','outflow']);
  const colN = guessCol(headerMap, ['—Å–∞–ª—å–¥–æ','saldo','balance']);
  const colSt= guessCol(headerMap, ['—Å—Ç–∞—Ç—É—Å','status']);

  if(!colT || !colY || !colS){
    console.warn('MIG: –Ω–µ —É–¥–∞–ª–æ—Å—å –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–ª—é—á–µ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏', {colT,colY,colS});
    return [];
  }

  const out=[];
  for(const r of rows){
    const t = cleanTerritory(r[colT]); if(!t) continue;
    const y = toInt(r[colY]); if(!y) continue;
    const s = normSex(r[colS]); if(!s) continue;
    const infl = colI? toInt(r[colI]) : null;
    const outf = colO? toInt(r[colO]) : null;
    let   sald = colN? toInt(r[colN]) : null;
    if(sald==null && infl!=null && outf!=null) sald = infl-outf;
    const st   = colSt? trim(r[colSt]) : (y<=2023? '–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ':'–ø—Ä–æ–≥–Ω–æ–∑');
    out.push({–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è:t, –ü–æ–ª:s, –ì–æ–¥:y, –ü—Ä–∏–±—ã–ª:infl, –í—ã–±—ã–ª:outf, –°–∞–ª—å–¥–æ:sald, –°—Ç–∞—Ç—É—Å:st});
  }
  out.sort((a,b)=> a.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è.localeCompare(b.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è) || a.–ü–æ–ª.localeCompare(b.–ü–æ–ª) || (a.–ì–æ–¥-b.–ì–æ–¥));
  return out;
}

// ------------------- –ü–∞—Ä—Å–∏–Ω–≥ XLSX: –≤–æ–∑—Ä–∞—Å—Ç √ó –≥–æ–¥ -------------------
function parseWideSheetToTidy(rows, sexLabel, statusRule){
  // –§–æ—Ä–º–∞—Ç —Ñ–∞–π–ª–æ–≤: –ø–µ—Ä–≤–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –∑–∞–≥–æ–ª–æ–≤–∫–∏ "–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è | –ì–æ–¥ | 0 | 1 | ... 100+",
  // –¥–∞–ª–µ–µ –ø–æ –Ω–µ—Å–∫–æ–ª—å–∫—É —Å—Ç—Ä–æ–∫ –Ω–∞ –æ–¥–∏–Ω —Ä–µ–≥–∏–æ–Ω (—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–µ –±–ª–æ–∫–∞).
  if(!rows || !rows.length) return [];

  let hdrIdx = -1;
  let idxTerr = null, idxYear = null;

  for(let i=0;i<Math.min(rows.length,20);i++){
    const r = rows[i] || [];
    r.forEach((cell, j)=>{
      const s = trim(cell).toLowerCase();
      if(s==='—Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è' || s==='territory') idxTerr = j;
      if(s==='–≥–æ–¥' || s==='year') idxYear = j;
    });
    if(idxTerr!=null && idxYear!=null){ hdrIdx = i; break; }
  }
  if(hdrIdx<0 || idxTerr==null || idxYear==null) return [];

  const hdr = rows[hdrIdx] || [];
  const ageCols = [];
  for(let j=0;j<hdr.length;j++){
    if(j===idxTerr || j===idxYear) continue;
    const s = trim(hdr[j]);
    if(/^\d+$/.test(s) || s==='100+' || s.includes('–∏ –±–æ–ª–µ–µ')) ageCols.push(j);
  }
  if(!ageCols.length) return [];

  const tidy=[];
  let lastTerr='';

  for(let i=hdrIdx+1;i<rows.length;i++){
    const r = rows[i] || [];
    const terrRaw = r[idxTerr];
    const terr = terrRaw ? cleanTerritory(terrRaw) : lastTerr;
    if(!terr) continue;
    lastTerr = terr;

    const year = toInt(r[idxYear]);
    if(year==null) continue;

    for(const j of ageCols){
      const ageTxt = trim(hdr[j]);
      const age = ageTxt==='100+' ? 100 : toInt(ageTxt);
      if(age==null) continue;
      const v = toNum(r[j]);
      if(v==null) continue;
      tidy.push({
        –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è: terr,
        –ü–æ–ª: sexLabel,
        –ì–æ–¥: year,
        –í–æ–∑—Ä–∞—Å—Ç: age,
        –ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å: v,
        –°—Ç–∞—Ç—É—Å: statusRule(year)
      });
    }
  }

  tidy.sort((a,b)=>
    a.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è.localeCompare(b.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è) ||
    a.–ü–æ–ª.localeCompare(b.–ü–æ–ª) ||
    (a.–ì–æ–¥-b.–ì–æ–¥) ||
    (a.–í–æ–∑—Ä–∞—Å—Ç-b.–í–æ–∑—Ä–∞—Å—Ç)
  );
  return tidy;
}

async function loadPopulationFromXLSX(cfg){
  const statusRule = (y)=> (y<=2025? '–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ':'–ø—Ä–æ–≥–Ω–æ–∑');
  const tidy = [];

  if(cfg.female){
    const bufF = await fetchArrayBuffer(cfg.female);
    const wbF = XLSX.read(bufF, {type:'array'});
    wbF.SheetNames.forEach(sh=>{
      const rows = XLSX.utils.sheet_to_json(wbF.Sheets[sh], {header:1, raw:true});
      const parsed = parseWideSheetToTidy(rows, '–ñ–µ–Ω—â–∏–Ω—ã', statusRule);
      for(const rec of parsed) tidy.push(rec);
    });
  }
  if(cfg.male){
    const bufM = await fetchArrayBuffer(cfg.male);
    const wbM = XLSX.read(bufM, {type:'array'});
    wbM.SheetNames.forEach(sh=>{
      const rows = XLSX.utils.sheet_to_json(wbM.Sheets[sh], {header:1, raw:true});
      const parsed = parseWideSheetToTidy(rows, '–ú—É–∂—á–∏–Ω—ã', statusRule);
      for(const rec of parsed) tidy.push(rec);
    });
  }
  tidy.sort((a,b)=>
    a.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è.localeCompare(b.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è) ||
    a.–ü–æ–ª.localeCompare(b.–ü–æ–ª) ||
    (a.–ì–æ–¥-b.–ì–æ–¥) ||
    (a.–í–æ–∑—Ä–∞—Å—Ç-b.–í–æ–∑—Ä–∞—Å—Ç)
  );
  return tidy;
}

// ------------------- –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ -------------------
function uniqueTerrs(arr){
  const s = new Set();
  arr.forEach(r=>{ if(r && r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è) s.add(r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è); });
  return Array.from(s).sort((a,b)=> a.localeCompare(b));
}

function countTerrs(arr){
  return uniqueTerrs(arr).length;
}

function showSummary(){
  const log = document.getElementById('logBox');
  const lines = [];

  const terrLE  = countTerrs(state.le);
  const terrTFR = countTerrs(state.tfr);
  const terrMIG = countTerrs(state.mig);
  const terrPW  = countTerrs(state.pop_with);
  const terrPN  = countTerrs(state.pop_nom);

  lines.push('–°–≤–æ–¥–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö:');
  lines.push(`‚Ä¢ LE: ${state.le.length.toLocaleString('ru-RU')} –∑–∞–ø–∏—Å–µ–π, —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π: ${terrLE}`);
  lines.push(`‚Ä¢ TFR: ${state.tfr.length.toLocaleString('ru-RU')} –∑–∞–ø–∏—Å–µ–π, —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π: ${terrTFR}`);
  lines.push(`‚Ä¢ –ú–∏–≥—Ä–∞—Ü–∏—è: ${state.mig.length.toLocaleString('ru-RU')} –∑–∞–ø–∏—Å–µ–π, —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π: ${terrMIG}`);
  lines.push(`‚Ä¢ –í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å (—Å –º–∏–≥—Ä–∞—Ü–∏–µ–π): ${state.pop_with.length.toLocaleString('ru-RU')} –∑–∞–ø–∏—Å–µ–π, —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π: ${terrPW}`);
  lines.push(`‚Ä¢ –í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å (–±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏): ${state.pop_nom.length.toLocaleString('ru-RU')} –∑–∞–ø–∏—Å–µ–π, —Ç–µ—Ä—Ä–∏—Ç–æ—Ä–∏–π: ${terrPN}`);
  lines.push('');

  const warns = [];
  if(!state.le.length)  warns.push('! LE: –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º–µ–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫ –∏ –∫–æ–¥–∏—Ä–æ–≤–∫—É —Ñ–∞–π–ª–∞ LE_Russia_subjects_forecast_2100_long.csv');
  if(!state.tfr.length) warns.push('! TFR: –Ω–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∏ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º–µ–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫ –∏ –∫–æ–¥–∏—Ä–æ–≤–∫—É —Ñ–∞–π–ª–∞ TFR_Russia_subjects_ML_GP_UCM_tidy.csv');
  if(!state.pop_with.length && !state.pop_nom.length)
    warns.push('! –í–æ–∑—Ä–∞—Å—Ç–Ω–∞—è —á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å: –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö (—Å –º–∏–≥—Ä–∞—Ü–∏–µ–π –∏/–∏–ª–∏ –±–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏). –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á–µ—Ç—ã—Ä–µ —Ñ–∞–π–ª–∞ POP_wide_*.xlsx');
  if(!warns.length) warns.push('–û—à–∏–±–æ–∫ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ.');
  lines.push('–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è:');
  warns.forEach(w=>lines.push(w));

  log.textContent = lines.join('\n');
}

async function loadAll(){
  const log = document.getElementById('logBox');
  log.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö‚Ä¶';
  try{
    const [leR, tfrR, migR] = await Promise.all([
      parseCSV(files.le),
      parseCSV(files.tfr),
      parseCSV(files.mig)
    ]);
    state.le  = normalizeLE(leR);
    state.tfr = normalizeTFR(tfrR);
    state.mig = normalizeMIG(migR);

    const [popWith, popNom] = await Promise.all([
      loadPopulationFromXLSX(files.pop_xlsx.withMIG),
      loadPopulationFromXLSX(files.pop_xlsx.noMIG)
    ]);
    state.pop_with = popWith;
    state.pop_nom  = popNom;

    const terrs = new Set();
    [...state.le, ...state.tfr, ...state.mig, ...state.pop_with, ...state.pop_nom]
      .forEach(r=>{ if(r && r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è) terrs.add(r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è); });
    state.terrs = Array.from(terrs).sort((a,b)=> a.localeCompare(b));

    const yearsSet = new Set();
    [...state.pop_with, ...state.pop_nom].forEach(r=>{ if(r && r.–ì–æ–¥!=null) yearsSet.add(r.–ì–æ–¥); });
    const yall = Array.from(yearsSet);
    if(yall.length){
      state.years.min = Math.min(...yall, 2017);
      state.years.max = Math.max(...yall, 2100);
    }

    initUI();
    showSummary();
  }catch(e){
    console.error(e);
    log.innerHTML = '<span class="err">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: '+(e.message || e)+'</span>';
  }
}

// ------------------- –û—Ç—Ä–∏—Å–æ–≤–∫–∞ UI –∏ –≥—Ä–∞—Ñ–∏–∫–æ–≤ -------------------
function initUI(){
  const selT = document.getElementById('territorySel');
  selT.innerHTML = state.terrs.map(t=>`<option value="${t}">${t}</option>`).join('');
  if(state.terrs.length) selT.value = state.terrs[0];

  const yRange = document.getElementById('yearRange');
  const yInput = document.getElementById('yearInput');
  yRange.min = state.years.min;
  yRange.max = state.years.max;
  yRange.value = Math.min(2025, state.years.max);
  yInput.min = state.years.min;
  yInput.max = state.years.max;
  yInput.value = yRange.value;

  selT.addEventListener('change', renderAll);
  document.getElementById('scenarioSel').addEventListener('change', renderPyramid);
  yRange.addEventListener('input', e=>{
    yInput.value = e.target.value;
    renderPyramid();
  });
  yInput.addEventListener('input', e=>{
    const v = clampYear(parseInt(e.target.value,10));
    if(v!=null){
      yRange.value = v;
      yInput.value = v;
      renderPyramid();
    }
  });
  document.getElementById('chkMigMale').addEventListener('change', renderMigration);
  document.getElementById('chkMigFem').addEventListener('change', renderMigration);
  document.getElementById('chkMigTot').addEventListener('change', renderMigration);
  document.getElementById('btnTFRPNG').onclick = ()=> Plotly.downloadImage('chartTFR', {format:'png', filename:'tfr'});
  document.getElementById('btnLEPNG').onclick  = ()=> Plotly.downloadImage('chartLE',  {format:'png', filename:'life_expectancy'});
  document.getElementById('btnMigPNG').onclick = ()=> Plotly.downloadImage('chartMIG', {format:'png', filename:'migration'});
  document.getElementById('btnPopPNG').onclick = ()=> Plotly.downloadImage('chartPop', {format:'png', filename:'population_total'});
  document.getElementById('btnPyrPNG').onclick = ()=> Plotly.downloadImage('chartPYR', {format:'png', filename:'population_pyramid'});

  document.getElementById('btnTFRXLSX').onclick = exportTFRXLSX;
  document.getElementById('btnLEXLSX').onclick  = exportLEXLSX;
  document.getElementById('btnMigXLSX').onclick = exportMigXLSX;
  document.getElementById('btnPopXLSX').onclick = exportPopXLSX;
  document.getElementById('btnPyrXLSX').onclick = exportPyrXLSX;

  renderAll();
}

function renderAll(){
  renderTFR();
  renderLE();
  renderPopTotal();
  renderMigration();
  renderPyramid();
}

function exportTFRXLSX(){
  const terr = document.getElementById('territorySel').value;
  const rows = state.tfr
    .filter(r=> r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è===terr)
    .map(r=>({
      –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è:r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è,
      –ì–æ–¥:r.–ì–æ–¥,
      '–°–ö–†, –¥–µ—Ç–µ–π –Ω–∞ –∂–µ–Ω—â–∏–Ω—É': r.TFR,
      –°—Ç–∞—Ç—É—Å:r.–°—Ç–∞—Ç—É—Å
    }));
  exportToXLSX(`tfr_${terr}.xlsx`, rows, '–°–ö–†');
}

function exportLEXLSX(){
  const terr = document.getElementById('territorySel').value;
  const rows = state.le
    .filter(r=> r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è===terr)
    .map(r=>({
      –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è:r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è,
      –ü–æ–ª:r.–ü–æ–ª,
      –ì–æ–¥:r.–ì–æ–¥,
      '–û–ü–ñ –ø—Ä–∏ —Ä–æ–∂–¥–µ–Ω–∏–∏, –ª–µ—Ç': r.LE,
      –°—Ç–∞—Ç—É—Å:r.–°—Ç–∞—Ç—É—Å
    }));
  exportToXLSX(`le_${terr}.xlsx`, rows, '–û–ü–ñ');
}

function exportPopXLSX(){
  const terr = document.getElementById('territorySel').value;
  const scenarios = [
    {key:'withMIG', title:'–° —É—á—ë—Ç–æ–º –º–∏–≥—Ä–∞—Ü–∏–∏'},
    {key:'noMIG', title:'–ë–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏'}
  ];
  const rows = [];
  for(const scen of scenarios){
    const src = (scen.key==='withMIG'? state.pop_with : state.pop_nom).filter(r=> r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è===terr);
    const grouped = new Map();
    src.forEach(r=>{
      const year = r.–ì–æ–¥;
      const rec = grouped.get(year) || {—á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å:0, —Å—Ç–∞—Ç—É—Å:r.–°—Ç–∞—Ç—É—Å};
      rec.—á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å += r.–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å || 0;
      rec.—Å—Ç–∞—Ç—É—Å = r.–°—Ç–∞—Ç—É—Å || rec.—Å—Ç–∞—Ç—É—Å;
      grouped.set(year, rec);
    });
    Array.from(grouped.keys()).sort((a,b)=>a-b).forEach(y=>{
      const info = grouped.get(y);
      rows.push({
        –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è:terr,
        –°—Ü–µ–Ω–∞—Ä–∏–π:scen.title,
        –ì–æ–¥:y,
        '–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å, —á–µ–ª–æ–≤–µ–∫': Math.round(info.—á–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å),
        –°—Ç–∞—Ç—É—Å:info.—Å—Ç–∞—Ç—É—Å
      });
    });
  }
  exportToXLSX(`population_${terr}.xlsx`, rows, '–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å');
}

function exportMigXLSX(){
  const terr = document.getElementById('territorySel').value;
  const showM = document.getElementById('chkMigMale').checked;
  const showF = document.getElementById('chkMigFem').checked;
  const showT = document.getElementById('chkMigTot').checked;
  const allowed = new Set();
  if(showM) allowed.add('–ú—É–∂—á–∏–Ω—ã');
  if(showF) allowed.add('–ñ–µ–Ω—â–∏–Ω—ã');
  if(showT) allowed.add('–í—Å–µ–≥–æ');
  const rows = state.mig
    .filter(r=> r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è===terr && allowed.has(r.–ü–æ–ª))
    .map(r=>({
      –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è:r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è,
      –ü–æ–ª:r.–ü–æ–ª,
      –ì–æ–¥:r.–ì–æ–¥,
      '–ü—Ä–∏–±—ã–ª–æ, —á–µ–ª–æ–≤–µ–∫': r.–ü—Ä–∏–±—ã–ª,
      '–í—ã–±—ã–ª–æ, —á–µ–ª–æ–≤–µ–∫': r.–í—ã–±—ã–ª,
      '–°–∞–ª—å–¥–æ, —á–µ–ª–æ–≤–µ–∫': r.–°–∞–ª—å–¥–æ,
      –°—Ç–∞—Ç—É—Å:r.–°—Ç–∞—Ç—É—Å
    }));
  exportToXLSX(`migration_${terr}.xlsx`, rows, '–ú–∏–≥—Ä–∞—Ü–∏—è');
}

function exportPyrXLSX(){
  const terr = document.getElementById('territorySel').value;
  const scen = document.getElementById('scenarioSel').value;
  const year = getSelectedYear();
  const title = scen==='withMIG'? '–° —É—á—ë—Ç–æ–º –º–∏–≥—Ä–∞—Ü–∏–∏' : '–ë–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏';
  const src  = (scen==='withMIG'? state.pop_with : state.pop_nom)
                 .filter(r=> r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è===terr && r.–ì–æ–¥===year);
  const rows = src.map(r=>({
    –¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è:r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è,
    –°—Ü–µ–Ω–∞—Ä–∏–π:title,
    –ì–æ–¥:r.–ì–æ–¥,
    –í–æ–∑—Ä–∞—Å—Ç:r.–í–æ–∑—Ä–∞—Å—Ç,
    –ü–æ–ª:r.–ü–æ–ª,
    '–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å, —á–µ–ª–æ–≤–µ–∫': r.–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å,
    –°—Ç–∞—Ç—É—Å:r.–°—Ç–∞—Ç—É—Å
  }));
  exportToXLSX(`pyramid_${terr}_${year}.xlsx`, rows, '–ü–∏—Ä–∞–º–∏–¥–∞');
}

// ----- TFR -----
function renderTFR(){
  const terr = document.getElementById('territorySel').value;
  const rows = state.tfr.filter(r=> r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è===terr);
  const fact = rows.filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–Ω–∞–±'));
  const fcst = rows.filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–ø—Ä–æ–≥'));
  const tr=[];
  if(fact.length){
    tr.push({
      x: fact.map(d=>d.–ì–æ–¥),
      y: fact.map(d=>d.TFR),
      mode:'lines',
      line:{color:'#1f77b4', width:2},
      name:'–°–ö–† (—Ñ–∞–∫—Ç)'
    });
  }
  if(fcst.length){
    tr.push({
      x: fcst.map(d=>d.–ì–æ–¥),
      y: fcst.map(d=>d.TFR),
      mode:'lines',
      line:{color:'#1f77b4', width:2, dash:'dash'},
      name:'–°–ö–† (–ø—Ä–æ–≥–Ω–æ–∑)'
    });
  }
  const layout = {
    margin:{l:60,r:20,t:20,b:40},
    yaxis:{title:'–î–µ—Ç–µ–π –Ω–∞ –æ–¥–Ω—É –∂–µ–Ω—â–∏–Ω—É', zeroline:false},
    xaxis:{title:'–ì–æ–¥'},
    legend:{orientation:'h'}
  };
  Plotly.newPlot('chartTFR', tr, layout, {responsive:true, displayModeBar:false});
}

// ----- –û–ü–ñ -----
function renderLE(){
  const terr = document.getElementById('territorySel').value;
  const rows = state.le.filter(r=> r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è===terr);
  const males = rows.filter(r=> r.–ü–æ–ª==='–ú—É–∂—á–∏–Ω—ã');
  const fems  = rows.filter(r=> r.–ü–æ–ª==='–ñ–µ–Ω—â–∏–Ω—ã');

  const mf = males.filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–Ω–∞–±'));
  const mc = males.filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–ø—Ä–æ–≥'));
  const ff = fems .filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–Ω–∞–±'));
  const fc = fems .filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–ø—Ä–æ–≥'));

  const tr=[];
  if(mf.length) tr.push({x:mf.map(d=>d.–ì–æ–¥), y:mf.map(d=>d.LE), mode:'lines', line:{color:'#1f77b4'}, name:'–ú—É–∂—á–∏–Ω—ã (—Ñ–∞–∫—Ç)'});
  if(mc.length) tr.push({x:mc.map(d=>d.–ì–æ–¥), y:mc.map(d=>d.LE), mode:'lines', line:{color:'#1f77b4', dash:'dash'}, name:'–ú—É–∂—á–∏–Ω—ã (–ø—Ä–æ–≥–Ω–æ–∑)'});
  if(ff.length) tr.push({x:ff.map(d=>d.–ì–æ–¥), y:ff.map(d=>d.LE), mode:'lines', line:{color:'#d62728'}, name:'–ñ–µ–Ω—â–∏–Ω—ã (—Ñ–∞–∫—Ç)'});
  if(fc.length) tr.push({x:fc.map(d=>d.–ì–æ–¥), y:fc.map(d=>d.LE), mode:'lines', line:{color:'#d62728', dash:'dash'}, name:'–ñ–µ–Ω—â–∏–Ω—ã (–ø—Ä–æ–≥–Ω–æ–∑)'});

  const layout = {
    margin:{l:60,r:20,t:20,b:40},
    yaxis:{title:'–õ–µ—Ç', zeroline:false},
    xaxis:{title:'–ì–æ–¥'},
    legend:{orientation:'h'}
  };
  Plotly.newPlot('chartLE', tr, layout, {responsive:true, displayModeBar:false});
}

// ----- –ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞—Å–µ–ª–µ–Ω–∏—è (–∏—Ç–æ–≥–æ) -----
function renderPopTotal(){
  const terr = document.getElementById('territorySel').value;
  const scenarios = [
    {key:'withMIG', title:'–° —É—á—ë—Ç–æ–º –º–∏–≥—Ä–∞—Ü–∏–∏', color:'#2ca02c'},
    {key:'noMIG', title:'–ë–µ–∑ –º–∏–≥—Ä–∞—Ü–∏–∏', color:'#9467bd'}
  ];

  const tr=[];
  for(const scen of scenarios){
    const src = (scen.key==='withMIG'? state.pop_with : state.pop_nom).filter(r=> r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è===terr);
    if(!src.length) continue;
    const grouped = new Map();
    src.forEach(r=> grouped.set(r.–ì–æ–¥, (grouped.get(r.–ì–æ–¥)||0) + (r.–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å||0)));

    const factYears = new Set(src.filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–Ω–∞–±')).map(r=> r.–ì–æ–¥));
    const years = Array.from(grouped.keys()).sort((a,b)=>a-b);
    const xFact = years.filter(y=> factYears.has(y));
    const yFact = xFact.map(y=> grouped.get(y));
    const xFcst = years.filter(y=> !factYears.has(y));
    const yFcst = xFcst.map(y=> grouped.get(y));

    if(xFact.length) tr.push({x:xFact, y:yFact, mode:'lines', line:{color:scen.color, width:3}, name:`${scen.title} (—Ñ–∞–∫—Ç)`});
    if(xFcst.length) tr.push({x:xFcst, y:yFcst, mode:'lines', line:{color:scen.color, dash:'dash', width:3}, name:`${scen.title} (–ø—Ä–æ–≥–Ω–æ–∑)`});
  }

  if(!tr.length){
    Plotly.purge('chartPop');
    return;
  }

  const layout = {
    margin:{l:70,r:20,t:30,b:40},
    yaxis:{title:'–ß–µ–ª–æ–≤–µ–∫', zeroline:false, separatethousands:true},
    xaxis:{title:'–ì–æ–¥'},
    legend:{orientation:'h'}
  };
  Plotly.newPlot('chartPop', tr, layout, {responsive:true, displayModeBar:false});
}

// ----- –ú–∏–≥—Ä–∞—Ü–∏—è -----
function renderMigration(){
  const terr = document.getElementById('territorySel').value;
  const showM = document.getElementById('chkMigMale').checked;
  const showF = document.getElementById('chkMigFem').checked;
  const showT = document.getElementById('chkMigTot').checked;

  const rows = state.mig.filter(r=> r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è===terr);
  if(!rows.length){
    Plotly.purge('chartMIG');
    return;
  }

  const sexes = [];
  if(showM) sexes.push('–ú—É–∂—á–∏–Ω—ã');
  if(showF) sexes.push('–ñ–µ–Ω—â–∏–Ω—ã');
  if(showT) sexes.push('–í—Å–µ–≥–æ');

  const colors = { '–ú—É–∂—á–∏–Ω—ã':'#1f77b4', '–ñ–µ–Ω—â–∏–Ω—ã':'#d62728', '–í—Å–µ–≥–æ':'#7f7f7f' };
  const traces = [];

  for(const sex of sexes){
    const rs = rows.filter(r=> r.–ü–æ–ª===sex);
    if(!rs.length) continue;
    const fact = rs.filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–Ω–∞–±'));
    const fcst = rs.filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–ø—Ä–æ–≥'));

    if(fact.length){
      traces.push({
        x: fact.map(d=>d.–ì–æ–¥),
        y: fact.map(d=> d.–°–∞–ª—å–¥–æ || 0),
        type:'bar',
        marker:{color:colors[sex], opacity:0.5},
        name:`–°–∞–ª—å–¥–æ ${sex} (—Ñ–∞–∫—Ç)`
      });
    }
    if(fcst.length){
      traces.push({
        x: fcst.map(d=>d.–ì–æ–¥),
        y: fcst.map(d=> d.–°–∞–ª—å–¥–æ || 0),
        type:'bar',
        marker:{color:colors[sex], opacity:0.25},
        name:`–°–∞–ª—å–¥–æ ${sex} (–ø—Ä–æ–≥–Ω–æ–∑)`
      });
    }
  }

  function pushLine(sex, kind){
    const rs = rows.filter(r=> r.–ü–æ–ª===sex);
    if(!rs.length) return;
    const fact = rs.filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–Ω–∞–±'));
    const fcst = rs.filter(r=> (r.–°—Ç–∞—Ç—É—Å||'').toLowerCase().startsWith('–ø—Ä–æ–≥'));
    const col = colors[sex];
    const label = kind==='I' ? '–ü—Ä–∏–±—ã–ª' : '–í—ã–±—ã–ª';

    if(fact.length){
      traces.push({
        x: fact.map(d=>d.–ì–æ–¥),
        y: fact.map(d=> kind==='I' ? (d.–ü—Ä–∏–±—ã–ª||0) : (d.–í—ã–±—ã–ª||0)),
        mode:'lines',
        line:{color:col, width:2},
        name:`${label} ${sex} (—Ñ–∞–∫—Ç)`
      });
    }
    if(fcst.length){
      traces.push({
        x: fcst.map(d=>d.–ì–æ–¥),
        y: fcst.map(d=> kind==='I' ? (d.–ü—Ä–∏–±—ã–ª||0) : (d.–í—ã–±—ã–ª||0)),
        mode:'lines',
        line:{color:col, width:2, dash:'dash'},
        name:`${label} ${sex} (–ø—Ä–æ–≥–Ω–æ–∑)`
      });
    }
  }

  for(const sex of sexes){
    pushLine(sex,'I');
    pushLine(sex,'O');
  }

  const layout = {
    barmode:'overlay',
    margin:{l:70,r:20,t:20,b:40},
    yaxis:{title:'–ß–µ–ª–æ–≤–µ–∫', separatethousands:true},
    xaxis:{title:'–ì–æ–¥'},
    legend:{orientation:'h'}
  };
  Plotly.newPlot('chartMIG', traces, layout, {responsive:true, displayModeBar:false});
}

// ----- –ü–æ–ª–æ–≤–æ–∑—Ä–∞—Å—Ç–Ω–∞—è –ø–∏—Ä–∞–º–∏–¥–∞ -----
function renderPyramid(){
  const terr = document.getElementById('territorySel').value;
  const scen = document.getElementById('scenarioSel').value;
  const year = getSelectedYear();
  const src  = (scen==='withMIG'? state.pop_with : state.pop_nom)
                 .filter(r=> r.–¢–µ—Ä—Ä–∏—Ç–æ—Ä–∏—è===terr && r.–ì–æ–¥===year);

  if(!src.length){
    Plotly.purge('chartPYR');
    return;
  }

  const male = [];
  const female = [];
  const ages = [];

  for(let a=0;a<=100;a++){
    const m = src.find(r=> r.–ü–æ–ª==='–ú—É–∂—á–∏–Ω—ã' && r.–í–æ–∑—Ä–∞—Å—Ç===a);
    const f = src.find(r=> r.–ü–æ–ª==='–ñ–µ–Ω—â–∏–Ω—ã' && r.–í–æ–∑—Ä–∞—Å—Ç===a);
    male.push( m ? -Math.round(m.–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å || 0) : 0 );
    female.push( f ? Math.round(f.–ß–∏—Å–ª–µ–Ω–Ω–æ—Å—Ç—å || 0) : 0 );
    ages.push(a===100 ? '100+' : String(a));
  }

  const maxVal = Math.max(...male.map(v=> Math.abs(v)), ...female);
  const tickStep = niceStep(maxVal || 1);
  const ticks = [];
  const stepsCount = Math.max(1, Math.ceil(maxVal / tickStep));
  for(let i=-stepsCount; i<=stepsCount; i++) ticks.push(i * tickStep);

  const traces = [
    {
      type:'bar',
      x: male,
      y: ages,
      orientation:'h',
      name:'–ú—É–∂—á–∏–Ω—ã',
      marker:{color:'#1f77b4'},
      hovertemplate:'%{y} –ª–µ—Ç: %{text} —á–µ–ª.<extra></extra>',
      text: male.map(v=> Math.abs(v).toLocaleString('ru-RU'))
    },
    {
      type:'bar',
      x: female,
      y: ages,
      orientation:'h',
      name:'–ñ–µ–Ω—â–∏–Ω—ã',
      marker:{color:'#d62728'},
      hovertemplate:'%{y} –ª–µ—Ç: %{text} —á–µ–ª.<extra></extra>',
      text: female.map(v=> v.toLocaleString('ru-RU'))
    }
  ];

  const layout = {
    barmode:'relative',
    margin:{l:70,r:20,t:10,b:40},
    xaxis:{
      title:'–ß–µ–ª–æ–≤–µ–∫',
      tickvals:ticks,
      ticktext:ticks.map(v=> Math.abs(v).toLocaleString('ru-RU')),
      zeroline:true,
      zerolinewidth:1
    },
    yaxis:{title:'–í–æ–∑—Ä–∞—Å—Ç, –ª–µ—Ç', categoryorder:'array', categoryarray:[...ages].reverse()},
    legend:{orientation:'h'}
  };

  Plotly.newPlot('chartPYR', traces, layout, {responsive:true, displayModeBar:false});
}

function getSelectedYear(){
  const range = document.getElementById('yearRange');
  const input = document.getElementById('yearInput');
  const v = clampYear(parseInt(input.value || range.value,10));
  const safe = v!=null? v : state.years.min;
  range.value = safe;
  input.value = safe;
  return safe;
}

function clampYear(v){
  if(!Number.isFinite(v)) return null;
  const min = parseInt(document.getElementById('yearRange').min,10);
  const max = parseInt(document.getElementById('yearRange').max,10);
  if(v<min) return min;
  if(v>max) return max;
  return v;
}

function niceStep(maxVal){
  if(maxVal<=0) return 1;
  const magnitude = Math.pow(10, Math.floor(Math.log10(maxVal)));
  const norm = maxVal / magnitude;
  if(norm<=2) return magnitude/2;
  if(norm<=5) return magnitude;
  return magnitude*2;
}

// –°—Ç–∞—Ä—Ç
loadAll();
</script>
</body>
</html>
